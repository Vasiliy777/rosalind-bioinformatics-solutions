package assemble

import org.scalatest._
import scala.collection.GenTraversableOnce
import utils.ReadFrom
import org.assertj.core.api
import scala.collection.JavaConverters._
import java.util


class StringCompositionSpec extends FlatSpec with Matchers with ReadFrom {

  "genome" should "be composed of kmers" in {
    val k = 5
    val genome = "CAATCCAAC"

    val expected = "AATCC\n     ATCCA\n     CAATC\n     CCAAC\n     TCCAA".split("\n").map(_.trim).toList

    assertResult(expected)(compose(k,genome))
  }

  "genome" should "be composed of kmers - extra" in {
    val k = 100
    val genome = readFrom("string_com_extra.txt")

    val expected = readAsList("string_com_extra_out.txt").toList.asJava

    val actual: util.List[String] = compose(k, genome).asJava
    api.Assertions.assertThat(actual).containsAll(expected)
  }

  "genome" should "be composed of kmers - test" in {
    val k = 100
    val genome = "CGCGTCTGGGGATACCCTGGAATGGGTCGGTCATTCGAGGTCGCCCAGAACATTTTAAGTTTTTCTACCAACAGCTGTTCATTGGAATCCCGATGAGTTAAGACTTCGGCGCATCCCCCATTACCTCGCTAAGCACGGCGCACAGTAACCGGGACATGAGGCACTGCCTGCAGAACTGCGTACCGAACGTCCCCCCGACGGTCCACACGAGTCTAACTTGTTGGCGCATTCTGACACTACTCAGTAATTTTCTTGTTTTACTTATATTTTCATTTTGATGTCCCAATTCATCCCATCCTCTCTGACTCTTCCAAGTCCCTAATACCAGGCCTGTGGCGTAGGGTAAGAGATCCTTTAATCTAAGTCAACATATCTTGGGTCTATCACGACTCGTGCAATCATATGCCCTCTCATTACATTCTTGGATATAGATGATAATGGAATAGCGATGAAAGTCAATGCTCAGGGCCGTGCCACCTGCTATCTGCGTATCGTTATATGCTTTCGTCAACTCAATATTCACGTATCTGTACTTTAGGTCCATCTCGTGGCTAGGAACGCCGATTACCAGGGCAAGCGGAGAAGCTAGATTCGATCAGGTGTACGTAGTCAGCCTCGCCTTCATTGCCGCGTCATGGCCGGAACGAGGTTGGCAGAGGAGAAGGACGGTCTATGATATCCCGTGGTTCACAACCGATGAGACCAACGCTTTACAGTAAACTCCCCGTGTGGAACACAATAGGCGCATCTATTGCTTTACCTGAACTTGAGCAGGACCCATCCAGGATACTTACCCCAGCCATCAAACATTAGACTTATGTATCTGGACATAACAAAGAGGAGTTCGGTTAGCACTCAGATATTGTGCATATTTTATTAACGTTCGCTTACTTCTGACTATCATGGAAGCATTACCAGAAGACGGCGTCCGGAGTTCGGAAGTCGTCCAGCGCTGCCATGACCTGCCGGTGCGGTACAGGTACTTGTTATAGCGCATCTACATATCCATAGATCCTCGCCTACTAGTTCATGGTGCTATGCACCTTTCCGGTCCTTATTACGTGAGGAAATGGGTAGCAAATACTAGTACAGGTTTAGGTCGCTAATCTGAACTCAATTACTAATAGCGCTCGGATCTACGTGGCTCTCTTAATTGCCTCACTGGTCCGCAAGGACACCTTTGCGAGCCAACCCATTCATGGTTAGGTATGGATACAACCCCCGTAACGCTCCTGCTCGCAAAACACCAGATGCGATGTCCCTTTGCCTTGCTCGAGGAGGAGGAAAAACGTCAGACTCCACAGATCGACGGACTAACGCCCCGTCTACTACCTATGACGTACGGGCCATTGCCAGTTCCCCTGCCGGCCGGTCAGATGTGACTAGAACGCCATTCTCGCTGTTTAAATAAACGCAAAATACAAATCGGATTCAACTTCCCTTTGATACGATCTGATGTCCATATACCGGCTACCTTCACGCCCGAGGCCGGCCAGGCGGGCGGTAGCGGTAAATATTATTTACAATCACTCGACATTAATTCTGTACGGTGATGCGCAACAAGAAGGTGTAGGGAGGGAGGGAGACCAGTTGACTTTTACCTCCAGCACAGCGATCCTACGAACATTTATCCCCGCACACTCACTATTGGGCTAGAACTTCTAAGCCAACTCTTGGCTTTGATGCACCCTATCCGCCTTCGGCCCGATCCTGGCCCGACGAAGCAACGCCTTGCCGAAAACCGCGTGCCTAATATATGGCCCCCGTGCATGCCTACCTCAGGGCCGCGGGCGACAGGCGATAGCGGCCTGGAACCATCGATCCGCTGCTAATGTTAAAAGGAACATAACATCGGAATATGGGATTGACCGCGTCATCCTTGATGCCATTGTAGATTCCGCTTGTCCCGGGAAATTACACACGGGCGTTTGGCGAAGCCAAAAATTACGCGATCTATAGCTTGATACTCTGCCGAAGGTAGTGGTGAAACTGTCTCCAGCCTTTAACGGATATGCTTGGGCCTATAGGATTCTTTCCAGCTGAGTAAGACCCTTTGAGTAACTAGGGCATCTGCATTCCGGTGAGTCCCACCCCGGTCGCTGGTGATTGGGGAAGTCAGATACAGAACACCCAAGCGTTGCACCTGTTACTATAAGTATCTCGTTTAGTGCCGTGTGGGCAAAACCCACACTGCTTCTACTAACGAAAATAAATGAGTCCATGCTCGCCGTAAGGCGTGTGGCTCGCGATGGATGGTCATGTTCTTACCAGGTCAGGCGTGTAAGGGTAACGTTGTCAAAATTTTTCCTATGGTTACCCAGGCTCGTCGTCAGGTACAAGGCTCTGTACTCACACTCGCCTAACGCAGCAATATGCTGGCACCTGGTAGACAAAAATCCCTTGTACTGCATACAAAAGCAGCAGACAGATTACGCGCCCTTGCGCGTCCCTGGCAGTCTTGGTGATAGGACCTCAATGTAAGTAAATGCGAGGCCTTGAACATCGACCCCAAATCTACCTTTCACGCGTTGCACTCTGGACTTTGGGTGACAATGTCGATATACAAGTTGCGCCTGCCAGGGGAGGTCCCGAGCCCCACAGGGGAGTCGCCGTTGAGAACCGATCGGCATTAAAATATGGCTGAGTTTTAGGCATGAGATGACGCGCCATGGTACCCGTCTACTGCGAACTATCCTTCAACCTGGTCCCTATCTGGGGGGGTGCAGGCACGTTTGTGGTACGTATGCTGCCCCATACAACCAGGGGTGCTCTAGAAGTGCGGGAGGGCTTTCCCGGCCAGATTCCGCTACGACGGAGAACTCGATGCTTCTGGGTCAAACAAGAGCTCTGTAGACTGCCGTCCCTTGATAAGCGGTCTATATCCGCTGTCCCGCGCATCGACTGCTGTGTGGTGACCTAACTCCCGGAAGGGAAGTAGCGCCAGCCAAGTAATAAAACGACATCCTCGCGGAGCCCACAACCGGGACCGACCCAGTTTGCCGCTGTGACAGACGTTTGTCCGGATGTGTTGACACTAGTCCTTCCGTGCGGGAAATTCGATCGGTTGGTAGGCGATACCACTACTAAATAAAGTTGCTCGTATCACCGGATCCTCTCTGGTGCCAAATGGATAGTGGGCTACGCCAATGTTGCATGTTGGACGCATATGGCTAACTTTCGTTTGCGCAAGCCATACATCTTCCCGTGCCGGCACGCTAAAAGTCACAACATTATTAATATATGCCTCGTACGTCTTACTTTTTCCCTCGATTGCGAGATCAGAGCCTTCCGACAGGGTGCAGGTCGGAACATACGTTTTACACTGTGGGTCATTGCGGATTACAGGTCCTCCCTAAAAGACGTGTGGTACCGCAACAGCTATTTTCGTTACACATTGCGCTTATTCAGATCGGGTTGGTTGACACAGCTTAGGACTATTCAGGTTCCGGCTCCGTTATGGTTACCATCGGGGCTAGCCATGCCATAGCAAGGCACGCTGAACGTGATAGTAACTCGTCGTACTACAGATCCCGCTAGCTAACAAGAGATCACAGACGCTACTATTCGGATTCCATGCAGTCGGCCGAAGGACGCTCACAGGGGGGACTAATGTGACTGACCACGATTCTGTAAATTGTCATACATTCATAGAAGATAGTGATCGTTTATAGTATCCGCAAAGTAGATATGGATATTCAGGTTGCGTGCGCATCTATAGGACATTTATCGCTACGGTTACACCGTCGACGTTTTCAGTTTAAGACGAAACTGTATCTTCCCTTCTTCTCTGGAAAATATCTACGCCACCGCACAGTCTTCAGATGATCAGGCCAGTCTACCTGCGATGAGTGCAGTACCTTGCCCACAGACGCTACCCGTGCGACCATGGGTGGACGAGGTCAGTGACCTGGGGCGCGTCAGGCTGGTAGTCATTGGGCCACTTACTATAACAAGGACACGAAAAGACTGGTCATGCTACCCGCCAACGGCTTAGAAAGAACGTTAAAGGCATAAACCAGCATCACCCTCAAGTCAATAAGGCAAACTCGATCAGTGCAAGTAGTCGTCAGGCTAGGTAACACACATACTCCGGTACAAGCGGCCAACCGACGTGATCCGCTCATGGAGAATCTGCAAGTAATGCGTATAGACGATCAAGCACCGCCGTATGTCGTAGAATACCCGGAGCGACCCAGTCCACAGTCCTTTGTCTGAGGAGCGGACACCCTGCGATTCCCGCCAGTGCTAAATACTGCGTCTAGGGGAGCTTACTTTTGTCGGCCTACTGCGATATAGAGGAAGTATAGCGGGACCCCTTTACGGACTCCTGATGGCGGAGCCTCGAGCCTGGTCACCACTACGAACGCCCTTAAGTGGGGATAGACCCGGGCTTCCTTTTCAGCGCCCGCTAGTACTTCACGAGTGGACCTGCCTTTTATACCGTGTTTATGATGGCTCCTGCCATGTGGTGGTGCATACCTGTCGCTGTTTACTGTGCCGGACCGTAAAGTCGCCCATTTGTGTCTCAATGGTCGCATTATTTTGATTGCTTGTCTTCTATACGCAGAGCTGATAAGGGCATAATAACAGGTCACGGTAGTACCCGCGCGGAAATTCGAGACCTCAGCGGAGGATCCAATAGTTCAATCTTTAACCGTAAGCTGACTCCATCGCTCCTCCGACCTCATGTTGGACTCGGATCCTTCCCTTGACCATCAAGAATCGAATTGGAACATCCGGCATTTATATCTGTCGGATGTGTGAGCAAGGCTGCGGGTCAGTACACGAATGAGTGGTGAGCCGCAAATCGTTTGTGCCAATTCAAACACCCGATATCAGGGGCCCCTCATCCCGGGCGAATCTTTCGACGATTAGTTTGAGGCCACAGGCTCGGTACTGTTAGGCACCATGAAAATTGCAACATGGCTCAATGGGATAACCCTCCGCTTGTGGATGGTCAAGCATGAGGACACATGGCCGTATTTTACCTGTAGCCTTATGAGTGGGCTGGGCGGCGGGCGAACGTTATTCGCATACCTCCTGGTGACATCTTAAACTGATAAGAGTATATGACCCTCTTACTCTAACACATTTCGAGAGTCTCATATTTGCAGAGATTGTCGACTGATAAATCCGCCGCGTATTGGATGACTATGTGTCGAGCGCGAATAAAACCTCAACGACGGAAGCAGGCTTTCCAGTTCGTAGCAGAATCGAGTCATGCAAGTCCATATTAGATGCTTTCGGACACGAGGAAGGGAAGTTAGGGGGGGAGGTAGCGCACCCCACGACTGGCAAGATCCATAGGACTTTTAGCGACTACTAGATATCTAGGGTCCAGTCATAACAACTCCACCTCGTATGCGCCAAGAGACAATCATCAAAAGAGAACAAAAGGTGCCAGAAGTCACGCTCTTGCGGTTGTCTAAGATTCGGTACTATTAGTTAGAATCATCATTCCACCTAGAGACGGATTGATTTTGGCCGTATATAGACTGATTGCCATGAATCGGCGAGGGCCGTGAACCAGCGGACCCGGGAAACGTTCATAGCCAATGGGTTTTCCTTCCCCCCCCGCCGCGTCTGACCGATGCGTACGCGTATTAACTCCCGACAACTCGAGTATGTCACTGTCATGACAGATTGTGCAGCCTTGGCTATTGTTAGCAGAAGGCTAAGGAGGGTACGAACAAGCTGTGCTTCGCTTCCGTGATGAACGCTAGTATAACCTTAACGGATCCTCTCAGTAGGACCTTTGGTACGCAACTGATCTTCGATCGCACAACCCACAGCGTGATGAAGTGACGGTCGCACACTGAAAAGTGTTTTGGGGCGCCATGGGATGGATAAGGCCTCCTGGCTAATCCCTGCACACAGGGTGATACTCGGAAATGGGAGCATTCCCCAAACGGGCCTATGGGTTGACATCAAAGATTCAACCCATTATCAGGAGGCCTATATCCTATAAGCGACAGACTGCTCGTTCGCCAAGGCAAAGTGCTAGATCTGGGGCCCCACCGGACTTTGTTCCTATCCTGACACGGGTCTTTACAGGAGCGGGATAGGGGGCCCATTAAATGGTGACAGACAAATCAGAAAGAGAGAACGAGGCCGCAGCCGTCTGGCGCTCGGAGATCCGGAATGGAACGGTGGGCAGCTGAAGTAGATACTGCGCGTGCACTACTTCTTTTAGCAGCATTTACCTTATAAGAGGGTTTTGTGGGTAGAGAACGCACGGGTTACATAGTTGACAAGTGACACCTAGTCGATACCACTAGAGCTTGTCTTAAAGTAACAGACCTCTGAATAGTATAACTCCTTGCACATATGGTGGGTGTCTTCAAGCCTCCTGACCACGCCACCTTGACAACTAAGTAAAGTAGTTGTACTTGATAGCTCGGTTTGACAACTATCATGCTTGAAAGACGTATTATACCTGTGAGTATAAACCATTTTGAGCTGAACGCAAAAGAGCATGTGGATCGCGTCTAATGCGCGAAACATACGCATCCGCTGCAGTTTTGACGTGTGTATTGACCCTTTCTCATAGAGGTATCCCCTGTTACCTTTGTGTGGAGGTATTAACACGGCTCGATCAAAGTTACACATTGAAGCAAAAAGATATTGCTAACGGCTTGACGCAGTAGTTATTGCTGAAATCTTCTGGCATGGTGGGGAGGCGGACTCTATGGTCTTAGTGATATCTCGTAGGCGGGTGTTCCGGCGTTGTTGTAAGAGATTTCGTCCTGGGTGGACCGGGTAGCGACGAGATAGTCGGTTCCTAGATAGTGGTACGCTTTAGCGAGTGCCCTATTAGTGCAGACTCAGGATTGCAGACCAATATTTCCACAAATGCTGAATCAATGCAACTGACGTGGGCAGGGAGGGGACACTCTCATAGCATCCCGGTCTCGCATATTTGATCTACCATCGCAAGAATACTTTTTCTGGAGTTTAGCTCACGCATGATCTGGTCTAAACATCAAGCCATAGTACGGTGTTATAAAGGATCTCAGGTGGCTGTAGCATATCTTAATAGATGCGAGGTTAATTGAACTTCAAGAGGGGATAAGGGATAATTATCTAGTACGCGGAGGAGCGCCGGGTATCTCCTTCTTGAGGTGCAGGCCGAGCGTAGTCACTGTACAACGTCAAGCACCACTGGGGGGCAGCCGGAGCATCAAGCTTTTATGTCCCTATCGTATCACTCTCTCTTAGTGAGCGCCCTATCTATGCGAACTCTAGCTGCAATCGAGCGTAAAGCGTTTTCTACCCTAGCAGGTCGTCGCCAGATATCTCGCGTACCGATGGGCTCCGAAATGCTTCGTAAAAGATCTGGCGCGTGATACTAAATCGTTAATGGAGTCGCAGGCCCGCAATCTAACTTAACTTCGAGTCTCATGACCCCCAGGCACCCATCAGCGGTCAAAAACGGGAACTTTACCGGTTACCTCTGGGGACAAGCCACAACTGCAGACCTATCTTGGCGCAGCCTATCTCCAAGAGAGAAATCAAAAATGTTCGAGTCAGACACCTGGCACGTTCTGAAACCAGTTGTCGGATTTAGGGTACAGCACTCATATACAGCCCCTCCTCATGGTGTTCAAGAGGTTTCCTTGCTTCCGCGCGTGACCTGGATGCACAATCGGTAGGGCGGGACGTGCTCCGAGGTTATTCTTTGTGAGTACGTGCACGCAAGTCGACCGACGCTAGTCCGTGCCTTCCACACATGACTACGAAGAAAAGTGGTTCCGCTGAGCGTGATAAGCCTCCGAACATTCTAATGACACCTGGATTGATCCTGCATCAACAGGAAAGACGTACTTACGCTCACAGTCCCTAGCAGTGTCCCGCGCCAGGAGTAAAACAAGTGACACGTAACCAATGTTCTTGTCGCTGTATGAAGATATGACGAGGCCCCACTGCTTCGTCTTCCGATGTTGTACTCCTACCACTAGCGATCTTAGCAATACATAGAGGTGGACCCTGGCATGCCATTGCGTTTGCATAGCACTTCGGCATGTCATAAAGTTACGCTCAAACAGTAGAGCACCGAAACAAGCCTTGGGAGTCTGTTTCGCCATTGGTACGTGTCTGACCGCGACGAAAGATATTCCTTCACTGTCACTAGGAGGCCCAATTGGTTAGCAAAGTCTGGGGGTTACCCTTATGAACGCGCAAATACCTCGAGCCTCGGCTCCGACCGAAGACGCAACCTATCTTCATTATGGTGGGCCGCGAGCCAGATGCGATAAAAAAGCTACTGAATTAGGACCCTGCACGACGAAGTAGTTTTCCTTAAACTCGGCGTGGTCTGAGCACTAAGAATCCAAAATTGAAGGTAAGTCACGGACCTGTAACGGCTCATCTCAACCCCGCTCCCGAAGCAAACTTCGGCAGACCCGCGGCCGATAATATGAGTCTTTAGCTGGCACCCGGTTGGGCTGAGAAGACCCTAAATCTCGTGACCCATGCAGGCTAGGATTTTCAGCAGTGTGGCGATAGTGCAGACAGCGTACGAACCTTTCGTTGGATCACAGAGAGTCTTGCGACCAAGCAACCAAGCATCGCCGACTCCTCTCCAGCACGGTACTAACTGTGACTGTTACACAGCGCGTTACACCACGTGTTGTCGGGTTCCGAACAAAAGGGAACGACTTAAAATCCGATGATCTAATTTTGAGGCGCCGTTGAGCGGTGCACTGGTGGTCTATGTCATCACTGGGTACCCGATACTAATGTCTGCGCGCAGTTAGGCGCATTACTCAGACACCATTGTCTCACCCGTCCGGCTAGTGATATGGGCTGGAACTTAGGTAAGTATCACTTTCGCCCGTTTTTAAAACCTGGACTAGATCAGTCAAGGGGATAGATATTACACTCCCAAATTGATCCTTTGTAGGAGAGGTTCGAGGGTGGTCATGCGTGGGTATCTGCCGTATTGAGCTTCGAAGTTCCATGACTTGATCTCACGCTAGTTGCCGACGAGCCTTATAAAATCTGAAATCTCCGGAACGCGAAATCGCAGTACCGCACGGGCGGTGTTCTGGGTGTAGTCAAAAAAGGGCGAGGTGTCAGTACCTCAGATTGAGCCCGAAAATTTGAGCTATATCGAATCGCCGGAAGTGGAGATTAGGCACCATGGTATGTTCCAAACCGACGACGTCAAAATTATCCGCGCCAAGAGGCGTCCGCTATCTTTAAGTTGGGCGACACGCGAACACGAGCTAACAGGCCTCATCCACAGGACTCAGCACAGTGACCGATGTACATAACCTGTTCCCTACGGCACACAGGAGCGAGAACGGTATTTCAGATTATATCGCATATCCGGTCTTGCGGTTAATGGAGGGTCACCTAATTAGATCGGCACGACAACATCAACTGGCGTAGTGTAACGCACCGTAGTTATTTAGAAAGCGGACCAGAACGGGTCATGCTCATACCAAACGGGAAGGATTACGCGCACCCACGATTAACAGATTCTACGCCGTGTATCTCAGCATGCAGCCTACATGGACTATTGCACTGCGTCAGATATTCCAGCTAGCGGTGGGGGACCTTTGACAATCCAAGAAATGACCTAGAGTGTCATTCCTAACCCCTTTGTCAGAAGCCGTGAGTTCTGATCCGGATCCGTCATGGGCCTGGGAACGCTCTACGTTACTTGCTCCGACGTCTGTTCTAACGTGGTACTATCGCCTCCCGGGGGTAGGCCGATTCCTGGCCAGTACAGCATGAGTCACCCGGGCAGTGCTGCCAGATTCTCGGTTTAGAAGGTGAAGTCACTCTACGTACATCGGCAAGAAGCGCATAATCTCAGGCGTGGGCTATCATAAGAAGTAGATAATTGGGTGGGAATATCGTGCTGATTTCAACGAAGTTATTAGGTAGGGGCTTAATAGCCGGACGGATAGAGTACTAGATTCAGGGGGGACATCAGCAACGCCCCCCTATCGTACTCGGTTCTTGAGTCGGTCCCTATACCGTATACTGCGGT"

    val expected = ""

    val actual: util.List[String] = compose(k, genome).asJava
    println(actual.asScala.mkString("\n"))
//    api.Assertions.assertThat(actual).contains(expected)
  }

  def compose(k:Int,genome:String):List[String] = {
    genome.sliding(k,1).toList.sorted
  }

}


