import org.apache.commons.lang3.StringUtils;
import org.apache.commons.lang3.mutable.MutableInt;
import org.junit.Test;

import java.math.BigDecimal;
import java.util.*;

import static org.apache.commons.lang3.StringUtils.*;
import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.offset;

public class ConsensusStringTest {

    @Test
    public void shouldCalculateProfileMatrixForOneGenome() {
        String genome = "ATCCAGCT";

        ProfileMatrix matrix = createForGenomes(genome);

        assertThat(matrix.profileFor('A')).containsExactly(1, 0, 0, 0, 1, 0, 0, 0);
        assertThat(matrix.profileFor('C')).containsExactly(0,0,1,1,0,0,1,0);
        assertThat(matrix.profileFor('G')).containsExactly(0,0,0,0,0,1,0,0);
        assertThat(matrix.profileFor('T')).containsExactly(0,1,0,0,0,0,0,1);
    }

    @Test
    public void shouldCalculateProfileMatrixForTwoGenomes() {

        ProfileMatrix matrix = createForGenomes("ATCCAGCT","GGGCAACT");

        assertThat(matrix.profileFor('A')).containsExactly(1,0,0,0,2,1,0,0);
        assertThat(matrix.profileFor('C')).containsExactly(0,0,1,2,0,0,2,0);
        assertThat(matrix.profileFor('G')).containsExactly(1,1,1,0,0,1,0,0);
        assertThat(matrix.profileFor('T')).containsExactly(0,1,0,0,0,0,0,2);
    }

    @Test
    public void shouldCalculateProfileMatrixForThreeGenomes() {

        ProfileMatrix matrix = createForGenomes("ATCCAGCT","GGGCAACT","GTCCCAGG");

        assertThat(matrix.profileFor('A')).containsExactly(1,0,0,0,2,2,0,0);
        assertThat(matrix.profileFor('C')).containsExactly(0,0,2,3,1,0,2,0);
        assertThat(matrix.profileFor('G')).containsExactly(2,1,1,0,0,1,1,1);
        assertThat(matrix.profileFor('T')).containsExactly(0,2,0,0,0,0,0,2);
        assertThat(matrix.getConsensusString()).isEqualTo("GTCCAACT");
    }

    @Test
    public void shouldCalculateProfileMatrixAsStringFromListOfGenomes() {
        String input=">Rosalind_1\n" +
                "ATCCAGCT\n" +
                ">Rosalind_2\n" +
                "GGGCAACT\n" +
                ">Rosalind_3\n" +
                "ATGGATCT\n" +
                ">Rosalind_4\n" +
                "AAGCAACC\n" +
                ">Rosalind_5\n" +
                "TTGGAACT\n" +
                ">Rosalind_6\n" +
                "ATGCCATT\n" +
                ">Rosalind_7\n" +
                "ATGGCACT\n";

        ProfileMatrix matrix = createForGenomes(getGenomes(input));
        String output = matrix.getConsensusString()+"\n" + getNucleotideOutput(matrix);

        assertThat(output).isEqualTo("ATGCAACT\n" +
                "A: 5 1 0 0 5 5 0 0\n" +
                "C: 0 0 1 4 2 0 6 1\n" +
                "G: 1 1 6 3 0 1 0 0\n" +
                "T: 1 5 0 0 0 1 1 6");
    }

    @Test
    public void shouldCalculateProfileMatrixAsStringFromListOfGenomes_testCase1() {
        String input=">Rosalind_2372\n" +
                "TGCAAGTAGTCTAGATGATCGACCACCGAACAACTAATTTAATTGTTCCTTGCTTAACGA\n" +
                "AACTCAGTGAGATAGCCTCATGAGCGCAGCCGACGGGTCCAAATGAATGCTATGCGCTGA\n" +
                "ACTCTTTGTAAATTTGTAGTTTCCTAAAGCATGGTCATTCACGGGGTTCAGGTCCCTTCA\n" +
                "TGCACCGACCGCTCGTGGAGGTGACACAGTTACTGACAGTCCAATATTATCTATTTGGAA\n" +
                "TCGTCCAAGCATTATACATATGTTAGACCCGTGAAAGTGCCAATCCGCATTGCTTCCGGA\n" +
                "GTCGTCGGCGTGCTAATCGCTTCCACTTAGGGTGGTCGAGAACCCTCAGCCCATCTTCGG\n" +
                "ACCTAACGCACTTAACTCTTTCATATGGAAGCCGCAACATGGAACCGTAACCCGGTGACC\n" +
                "AGTGTGTGGGAGCAACCAGAGTAAATGAATTAAAGAGATTTGCCTGGTCAATGCCGCTGC\n" +
                "GCCACAAGTAATCACACTCATTTCCACTTCAAGCTCGTGAACCCAGAGGAACAGACTCGC\n" +
                "CATAGTCAGAGTTTGTGTTTTATAAGATACTCGTGATTTTAAGATGAGGCATCAATGGCA\n" +
                "CGATCGGGGGTCTCTTCAAGCCGAGGATACGGCTTAACTGAGGTCAGCCCGTAGAACAGG\n" +
                "TGCTGGACGTGCGTCCCTCTTACTTGGCCCGAGAGGCGATGCTAAAAACGTCGAGTGTAG\n" +
                "ACTGAGTCTGCTGCGGCCACAGTGGTACGCCCTGGAACTATTCGACCTCACAGTGCAGAA\n" +
                "TTTCATTGTTTGGTTTGCGTTACCTGGGCCGCCTGTTTGCACAGGTACTTCATCGTGGCG\n" +
                "CTTGCCCGACTCCTTAAATCGGCCGAGTATCGCGGCACTCTTAAGAGCCCATGTTGCAGG\n" +
                "GCACGCCAGTCAACCATATGATGTGAGGGTTCGGGTATGG\n" +
                ">Rosalind_0074\n" +
                "TTCCCTTACGCATGAGCTTCGAGCCAGAAAATTGATACTACTAGGCTCTGTGATATAATA\n" +
                "GAGGCCCCCACTGAGATGCGACTTTCTCTTGATAGTGGACACGTTCGCTAACACTCACCG\n" +
                "CAAGACTATGTAAAATTTATTATCTTCGAACTAGTGGTGCGAAGTGATCCCGCTGTCGGG\n" +
                "TGAACGCTCCGGTAAGCATTGAATAGGCTTTAGTCCTGTGCCCGAACGTGACTGCAACCC\n" +
                "ATCCGATCAGGACAGCGCACGCGGGATCTCCAGGCAATCCGGCTATTGAGTACCAGATTA\n" +
                "GATTCATCATTAATCAATTAGAGGTAAAAAAGTTAGTACGGATCCCGGGCGATTACTGCA\n" +
                "CAAAGTGGGGAGTAAGCTTCTTGTAGAGCAATGGAGCTGGTTAATCTCCCTGGAGCGGCG\n" +
                "AGACCGATCTGGAGGCGCCGTAGCGTCTACTCGTGTGAACAGTTAACTCTGACTCGCGTG\n" +
                "ACTCATAACTAAACGTAGTTATCCGCCGAGAAGGGTAGATCTGTGAATTTGACTCGCTAC\n" +
                "TGGCATACCCTTCAATGACCCCCAATACTCATAATTCATGGCGGTTAAAGCTCCGGATAC\n" +
                "GAACGGACTCGGACGCGACCGCTTGAATAACCTGCGGGACCTTGAGAACCAGCTGACGAA\n" +
                "CCACAAGCCCGTATTAGTGTACACCTTTCGCCAACATAAGGCATTTGGTCTATCGCAACA\n" +
                "GTGTTGCCACTAAGCACTGGAGCTACCGACCGTGGTCTCCCGCCTTACATAAAATGAGTC\n" +
                "TGTACTAGACCATTCACTATTCCAAAGTTAAGTGCACGTCCGAAGTAGTCTAACCTGTAA\n" +
                "AGAATCAGGGGGGTCTTCGATGCAAGTATAAAAGCAAATCCTAACACTAGCATGCGAGTT\n" +
                "GGGACGCACATTCGCCATCCAATGTCAGACGCGTGCCTTT\n" +
                ">Rosalind_9514\n" +
                "CAATGACTAGCGTCCGACAAGTAGCCCTAATCTCAGAGCGGGTGCCCTTGATTTACCATT\n" +
                "TCGCCCGCGCGGGTCACCTGAAAATTCCGCGCTCAGGACCTCCAATTCACTCTTGCTACC\n" +
                "ATGTGCTTGAAAGAAAAAAAGACGTCATCATCGTACGGGTTACGGTCTCATATTAGAGTA\n" +
                "AGTCGGAACACATGTTATCTAAACACAAATCAGCAAATTCCGAAACGCGGGGCACAATCC\n" +
                "AATGTAGGATTCGTATTAGGCGGATGTACGAAAATCGTAGCGGACCCCAGCACCATGGTA\n" +
                "GGCGAGAACGCGGGGCCGAACGCGTGCACGGATGATCACAGGTCCCAAGCACCCGATTGT\n" +
                "CGTCACATCGATTCTTGATACGCATGACAAAACCTGTAGTCGTCACGTTTGTATATGCAC\n" +
                "TCCTGACCATCTCGACACCGCATCTGTACCTACGCCGAGTCCCTATACCCAAAGCGGCTC\n" +
                "CCTTGTTCGAAGTTCCCAATTTCCTCCAGCGCTAGTCCACTGCGCCTCCGGCGACAGACC\n" +
                "AGTGGGAATGGGTCCGTATGTATATAAGTGCTGATAAATATAGTGCGGTTGAGGCTCGCA\n" +
                "ACGGATCCTGGGCTGGTAATTTGGAACTTCACCTTGTGGCTATACAATCACAGTTTGGGC\n" +
                "CGCCACACATGCCAGTCAAAAACTTAGAGTTTTCACTTGCTACCAATTTCCTGCCAGAAT\n" +
                "GATGAAGATGATGAAATCCCAGGAGCGTCTCGAACCAACACGGTTGAACAATTCGATTCT\n" +
                "GTTCATACAATTCCGGGCCTATCCGGATCCTATGGCGCTTTTTCGGGACGCGACTTACTG\n" +
                "ACCCATCGGTTTACAATTTTCCGTCAAGGTTATATTCGCATGATAATCATCTAAATGATA\n" +
                "GCTAGTTGCGGGGAGGATAGAACATCCTCATGTCTGACGA\n" +
                ">Rosalind_9063\n" +
                "TTTTAACTGGAAGGAAATGCGCCAGATACATCGTATCTTCGAGATTTACTCAGAAATCGT\n" +
                "GGTTCGAAGGCAGGATTTACGCTCAAGATTGTTTTCCTGTGACTGGAAATCTTTACGAAT\n" +
                "AAACACTAATATGTGCATGTTCCCAGTAAGGCATTTGATACGAATTCCGCGTCCTACTTA\n" +
                "GGCAATGTCCTTGGGTCCCACAGACGGTTCTCACCACACGTACATCTTCGGCTCATGAAT\n" +
                "CCTCATGAGGCAATTTGTGAGATGGGTGGACTATAGCCCCTCTCAACGATCAGACGTGAT\n" +
                "CTTGAGAGGCGATGTGGGGACGCACGGCTGGACCCTAAAGTTCGAGGAAGTGATATGCCA\n" +
                "TTATGGATCTACTTACTGAGCGCTCGGGTATTGAAGTTATAACATGGCACCGTCGTAAAG\n" +
                "ATCTCGAACTGAAGGACGCCTTGCAGGGTGCTTGCACTGCGCACCAAGACGGGTGAGGCT\n" +
                "GCCCGCATTCAGAGAGTTATTCCCTATGACTTACTTCTTGTCGTCCTAGGGGCCCTTTTC\n" +
                "TGGCCTAGTTCTTCGGTACCACTCGCCCTAACTCTTTTGACGGACAAGCGGACCGGTTCT\n" +
                "GTCCCTTTTCGTCCACAGTTACGCCCATATGGACCACTTTCTTGGGCATTTCTGAACCAT\n" +
                "CCAGTTTCACAACTCACACCTGTGGTCCCACGACCTAGACCTTAGCGATCACCGCTGGTA\n" +
                "CCGAGGTTGCAAGATGCCACAGCGACCAAACAAGTGGCCTAATTTAGAGGAAGATTATGG\n" +
                "TCCTCGTACGATAATCCACTCATGCATGGAGTATGCCGCCAAGCTGCGATACATTCCGTG\n" +
                "AGACACGGAAGATCTCTCGGAAGATGAGCTGTAGTGAAGAATTCCCTTCTTCGCTCGAGA\n" +
                "TTATAATCAGCGCTGATAACCCTTTGAAAGCCAGGCTAGG\n" +
                ">Rosalind_6240\n" +
                "ACTAGGTGAGAAAAAACCTTAACTTGGTAGGCAGCTTATTCCTGAAGAGCCAGGCAAAGT\n" +
                "AATCCGCGTGGAGCCTCGTCGACATTATTCGGATCCTGACGGACTGCGCATTTAATCATT\n" +
                "TGCTGTTGAAGTAGCCTAAGGAGTGAACCGTAAGTAAACGCGAGATGTAACCTCCATTAG\n" +
                "TTTACTGAGGTACCGGGGTTTGGCGGAGTGTCCCTGTTATCGTACCTTTGTGACCGCGGG\n" +
                "CATGTGATGGCAGTTCGGTAGAAATACAGTCAAGCACCCAATGTTATTTATCGTATTGTT\n" +
                "TAGCTCTGCACTCTATGTTGGTATTGGCTGGAACTAAAGAAATGGGGAGGGCCGACAGTC\n" +
                "GAAATACAAATAAGCTATCCTGCGCCGAGCCTTCGCAGCCAAAAGTCTCGGCCATCATTG\n" +
                "CGACGATGCGCGATTTCTGGAGATTGAATCAAGGCGAACGATGCCTCGACGGTGTGACGC\n" +
                "CAGTTTAGGTGGCGGGTAATTTTATACCGAGCCTAGGATATGTGGTTACCTAATGACACA\n" +
                "GGCATAACCAGGGGTCATAATGCGCCCATAACACACGGACTACCTGGATATCGCACGTTA\n" +
                "GCCGCGCGTGGGTATGCGTTAAATGGCAAGTCTGATCCCTTCCACCATGACTGCCCTCAA\n" +
                "TGAAATACAGCTGAGACGTACCATCAATTGGAGTGTGCCTTTCATCTAGTAAAACTGCGT\n" +
                "CAGTCAGCTGGTAGACATGTGGCACGTCATACCTGGACATATTCTCTCTTCTCGTCATGA\n" +
                "CGAGCTGACCCCGAGGAATTACTCTGACATCCTGCTTGCACCACTAATGCTACGTTTCTG\n" +
                "GACAGGATGCTCGACTGTATTATATTGGCTATCCACGGAGGCTAATGATGATGCAGCTCA\n" +
                "CCCGGGCCCGGAGCTGGGCATGGCGGCGGGACAGGATCAG\n" +
                ">Rosalind_0924\n" +
                "GGTAAGACTAAGGTGTGACTTCCTCCTCGTAGCAGTTGAGATGAGAACTAGTCAAAATAC\n" +
                "TAGGTTACCATTTACCAGGGGATCCGGGGACATAGCTACTATAATTGATGTAAGGGATCG\n" +
                "GTTTGTAGTTTCGAATTTTTGGCATAGGAAATTTTGTATTATCAAGTAGCCCCCTCCCTA\n" +
                "AGAGCAAGTGGGATTCAGTCACAACTAAGAAACACTGTTGTGTAAAGAACTATGACGCGG\n" +
                "TAACCGTTATAGGGCGGGTGGCTCCGGAAAAGGGGGTCCCGACAAAAGTTAAAGAGACGA\n" +
                "CTGTAAAGATCTTATGTCAGAATAAGGAGAAAAACGGTCAATTGCTACCAACAGCAGATT\n" +
                "CCATAAACAGAGGCCTGGACCCCGAGATGGATATACTGGTCGATGAGACGTTCGTAGTTG\n" +
                "GGGCAATGTTAAGACGTGCATATATTGCAGGGCCAAAGACAGATCTACCAGACCGGTGGA\n" +
                "AATCGGTTTCTATGGCACATTTTTCAACGAAAAATTTCATCAATAATAGGATTGCCCCGT\n" +
                "CGGGCGGTTTGACTTCACACTACTTAGAAACCCTTAATGAACGACGAGGAAGTACGCAGT\n" +
                "TAGAAGTGTGGATTCACCACACCACGCATTCGCGCCGTGGTTCTCAGATCGGATAATGTC\n" +
                "TACACCTACCAGTAATGTCGTTGCTAAGCCTTCGGGGTTTACCAAATTGGTCTTCCCTTA\n" +
                "TCCACCAGGACCTGCGCACAGCGTGAAGTGTGCTTTTGCGACCATGGGATCATGAAGTGC\n" +
                "TCAATAACCAGCACGCCCCATGGGCTCTTGCATTTGTGCACTCTCGACCCGGTTGGTAAA\n" +
                "TTCCTGTTTCCGATATGGCCCCATATCGGTAACCCAGACGATCCGGTTGGTGTCGAGAGC\n" +
                "CATAAACGTATATTCGATGCGAAGCGCAACGGTAAGCCTC\n" +
                ">Rosalind_7323\n" +
                "ATCGAGGCGCAGTGCTACTGTAAGGAACTTAACTTTATTATGGGTCGAAGTAACGGCGCT\n" +
                "GTAGATAGCACGGTACTGGGGGGGACCCTGGCAGGGTAAGTGATTTTAATAGATGTGGCG\n" +
                "TTTACCGCGCGGCAGGCGGGCGAGCTTATGTCTTAAGTCAACCGGGCGTCTCGGAAGATC\n" +
                "TCTGGTTAACCGGATGCCTATCAGATCGTAGGATAAGCGCCCGGACACTAGTTCTTTGAT\n" +
                "ATGTTGGACGGGTGACAAATATGGTGCAAACAGGTAGTGCTTTTCCCCATGGGTGGTTCT\n" +
                "GCGAAAGCTTTATCGGTTGTTCCGTCGTATTCGTGAGCTGAGTTATAACAGCTTTCTTAA\n" +
                "GTTAGGGATTAGAACGTCAGGGACCTCTGTCTTTTCGACCTTGTGGATGCGTTCTAGAAA\n" +
                "CGGATTCGTTCTCGCCTTCAATGGAGGTCCTTAACCCACCGAGGCCCTTCCGCTCATTTC\n" +
                "GATCCCTCCCTCTACGCGCTCCGCGAGCGACTCAACGGTGACAACGAAGACCGGGTTACA\n" +
                "TTCGTTAGGCAGTGACGATACAGCACAAAGGGCGGCTCGCGGAGACAAAGCAAGCGCTCA\n" +
                "AGATTCTCGTTAAACGATTGCCTTGTCCAAAATTGGCTCCTATTTATCGATAGCGTGGAC\n" +
                "TTCTGGACCATAATGATGTCTCGGGACGAACTTCATGATTCCTATCCAGGATAGGTCGAG\n" +
                "CGTTAAATGTTAAAGGGATAGGTATAATCCGCACAACCGACTCCCATGGACCTCGCTGAA\n" +
                "TGGACCACATGGCGGCCGCGGCACGCGAGCAGAGCAGGCACTGTCATAATCACGGGGAAC\n" +
                "AGACGTGGTCAGTACGCCTGGTATGCAACTCCCATGCCGCGCTAGGTAACAGGGCGTTGA\n" +
                "TGACGGCCACCCTAGCGTAATACGTGTTTGCGTATGGAAA\n" +
                ">Rosalind_3605\n" +
                "CACTTAATCTCTTAACGACCCCCCAAATGATTCCGGGCCCATGTCACTCGCTTCCCCAAC\n" +
                "AGAGTGCTTTCTGCGCTATGTAGGTCGCTTTTTGCATGTACCAATTGAAAAAAGGAACCC\n" +
                "CGAGGATTCGAAGCTCTATGGCGGGGGTCCGGCGAGCTCGTGGGGTACTACGCGATACGA\n" +
                "CTTCTTGACTTCTACGGATGATACCTTAGGGTCTCAGTCCACCCACTACATGCACTAACC\n" +
                "GTGTTGAATATTATCGACTTGGGCACGGTCAGGTACGTAACCTATCGTGCCACGTCTGCA\n" +
                "CCGGGCGGGTAATCAACAACGCCACCCGTATGACCTTGTGCCAATCAGCATCTCCCGGGG\n" +
                "GAGTAACGCGGCTCATGTGACTTCTGCGACGCGTCTAAGACATGCAGAGAACAATGTGAC\n" +
                "GCAAGATTCTACTACCAGATCATCATGCGCTCGTCTTTGTGTGCTGGAAACCAGGAGTCT\n" +
                "GTAGGAAAATATTCAACTCACCAGTGTTAGCTGTCAGAGAGTATTGCGTATCTCCGTTTA\n" +
                "GTGGTCCTCCTAAATTTACATATATTAGCCGGGATCTATCTGCGATGGCCACGGCTTAAG\n" +
                "CATGAGCCGGGCTCAGGGTGTGTGAGCTCAAGCCCTGCCATGCGATAGTTGATTCCGTAT\n" +
                "GAAATCTCTGGAGGGGGACGAAAAGTACCTCTCTTCATAGCCGAGAGCAAACTTACTGAG\n" +
                "TCTTTGAAGCAGCTCATGTGACCTTAAACGATTTTTACTTGAGACAACGATTAGTGCCGG\n" +
                "TGAAAAAAGGCGTACTATCCTTCGGCTGCTCGCCGGTTACGTAGGCGTCAGGTATCGGTT\n" +
                "CTGCGCCTGGTGCAGCCAGCCCGAGTATGGGGCAGTTAGTAAGGACGCTCCATAATCCTG\n" +
                "GTCTCAACCACAAAAACATCGCCCTGGATAGCCAGTTTCT\n" +
                ">Rosalind_7635\n" +
                "ACCAGTTTCCAGGTATACAACACTTAAGTGTACTTACTAATTTGGCAAGAACCACGTGCT\n" +
                "CCATGCTAATTAATTATCAAAAGGTTGATGCCGACGCCGATGAGGTACTTCCAAACACAT\n" +
                "TACCTATTCACTTATCCACTGGGAGCTACAGCGCCACGGTCTACCAGCTCTGTAAGTAGG\n" +
                "AGAGTAGGCGAGGATATGCCTTGTTATCTAAACAACGCAGACTTCAACGTCCCCATGTAC\n" +
                "CCTCCTTACCTCTTAGAACTCTCGAGGTATGAATGCTTTTCGACGCACTTTTTAAGCAAG\n" +
                "TGATAGTGATTATTATAGGGATCGACTGGGTGAAGACGGGGCATTGGGATCCTCCCCTTT\n" +
                "GGTTGCTTCTACCGCACTTGTTGGAACAATGTGCCTTGCACAGGCCGCTCCCATGCCGTT\n" +
                "AGGCTACTGCAGAGTTCTAGAAACTGGCGGGAAGAGCTTGTCAACCGGGTGCGCATTGTG\n" +
                "TCTGAGCCATTACCAAGCAGTGTATTTTATTATGGGAGGGCTGGTGACCAGTGCTGATCT\n" +
                "CTTCTATGAGGGTCAAATCGAAAGGATGCGATGGGTATGTCTGATAACGCACGAGGAAGG\n" +
                "GCCGATCGAATTCCATGTGCTTGAACTAGGTTCTGCACAATGTATTAACACAAAACAGCA\n" +
                "CCAGCTAGCCATCGTAAAGTTGGTGGTAGCAGATGAGGGTCATATGCTGGCGTATCTGCG\n" +
                "TGACCGCTTGTTGGATTTATAATTCCTGCGGCCTTGCAGGATAGTGTTCACCACTATCGG\n" +
                "TCAATCGAACGGTGAACAGGTAGCACACATTTACCGCCTCAACCGTTCGATTAGCTTGGA\n" +
                "ATAAGATCAGGCCGGGCAAAACGATCACCTCTAATAGATGATCCGACCGGTTACGTAATA\n" +
                "AGGCGTCGTGTCGATAAGTTGGGTACCTCACACATACGAG\n" +
                ">Rosalind_8329\n" +
                "TGTTAAAATGGTCTAACGTGTTAGGCGCGTAAGCATACCTGAGACCGGATGTCCGTAGGT\n" +
                "AGTGGTACAATGCAGTGACCCACATATTGGGGTTTGTCCCGACCGTTAGGGCAGATGTGT\n" +
                "TCACCACCATAGCTATTACAGAGACATGCTTTCGATACGGGAATCATAACATTAGAAGGA\n" +
                "GGTTTAGGCATCGGTGCACTCAGGGGCAGCTGGGTAATACAATTAACTCTCATACACAAA\n" +
                "AATGTAGGGGCCAATTGCAGCGACTGGGCAATTATCAAACCCCCGAGGAATGAAGACCTA\n" +
                "ATTATAGCGGACGTCCGGTAGGCGAATCTTATTGCAAAGACTCCGGTGGCAGGTGGACGC\n" +
                "ATAATTTGTCCGGAATCCTACGGTACTCGACTAGGTGATGTATAAACCGTTGCGCACTGA\n" +
                "CTACATATGAAACCCGAACTCTATGGTCTTGAGTTTTTATGTTAGTAAACACTCCACTCT\n" +
                "GTGCTTATACATTACAATCTAATTTACGGACTCACTGCCCCTACCGGCCTCTGTAGACTA\n" +
                "TACGCTGTAACTCCATAGAAATGTGCAACCGTCCAATGCACGTTTTATCAGGTAAGCATG\n" +
                "TCTCGTAGACCTCCTTAGAAATTTTAGCGGTCCCCAAGTGCCATGTACCTTTGTGCCGTC\n" +
                "ACACGTGATATAAGTCGTCTTTCTCGCGCGCCTTGAGTGGAAGACAAGTGGGTGCGGATC\n" +
                "GCGCTTGTATTGGTCATTAACAACAGCCGAAATTCGCCGCGTTGAGTAGTGCCATATCCT\n" +
                "AAAGCTGAGTCATTTCTCCACAGCCTATAAACATCGGTAAGACCCATGTCCACGGATGTA\n" +
                "CCCCATCCTTGACTCGTACCTTCCTTGTTACACGTCGAAGGGTAAATGCCGAGTTTGGCA\n" +
                "CAGGGCTGTGTTATAAACCCTTTACCCGTTCTCGTGGCAT";

        ProfileMatrix matrix = createForGenomes(getGenomes(input));
        String output = matrix.getConsensusString()+"\n" + getNucleotideOutput(matrix);

        assertThat(output).isEqualTo("TGCAAATTCGAGTGATACTCGACCCAACAAAACCATATTAATGGGCGACGCTCAAAAAGTAAAGCCACCACAGAGCTGCGGAGGTCGCTCGCTAGGTACCAAATTTAAAATCAGACAACTTAACGCTGAAAAGAACTAATGACATATACATCAGTAGTGGAAAGGGCTCCCGTCAAAGGATGTACTGACCTGGATGCGTTAAAACGAATATACTCAGTACCCTAAATTCGCCTCCTGAACAATCTGGAGGCAATTCGATAGGGGTGGAAAAAGGAAGTCCCCCTACCCATTACAAGTGTAGTGGAAGGATTATTAAGGGAGGCGACGATGGAACCAAACGAATCCGAAGCACTTCCTCGAGAATAAAGCGAGTAATCTTACGCTAGAGAAATGCACTAGTCAAACCGCCCCCCAGAGAAGAGACGATGCTAGAGCCCGCGAAACAGGCACTAGGCACAACGCACCTAGACGACCCGCGTCGCTCGTACACAATACACTATTTTCTACCGAAACAGTGCAACTATCGAACAGCGCCGTTCATGGGTTAGCAGGTCATAACATATAACAATCACGATATTGACGGATGAGCAAAGACGCACAGCAGAGCGTGGGCCAGAGACACGTGGCTAAACCTCAACCCTGTTCAAACACAGTAACGACCCAAATACCCGAATGACACTTAATGAACCCCTATGAGTATCCTATAGAGGACTACCGGAGCCGTAGATGGTTGGCACTAAAGCTACACCCCCTTTGACCAATCCTGTAGACAAATAATGATGAACTAAACCGTAGCCCCTTACCCCATAAACAGCGTGCCCTACGAACCCCAAGGTGGTAATACGCCGGCGGCTCGTAGCCCGATTAGCTCACATAGAGGATTAAATCACATGCAGGAGAGCAAGACCCGCAAACAATACAACGTGCGAACCCAGGCCAG\n" +
                "A: 3 2 1 4 5 4 3 3 2 1 5 3 2 2 7 3 4 3 2 2 1 5 3 1 2 5 3 2 4 5 4 4 2 1 4 2 5 1 2 3 3 3 1 3 1 3 2 4 2 2 2 3 2 3 4 4 5 4 2 2 4 4 3 0 1 1 4 2 2 5 0 4 1 4 2 3 1 2 2 2 3 6 2 3 2 2 1 3 0 1 0 2 3 3 1 1 0 3 3 2 3 3 6 3 1 1 3 5 4 3 3 3 6 2 4 1 4 3 2 1 3 3 4 1 2 3 1 2 3 4 5 4 2 5 4 1 2 6 3 2 0 4 1 3 1 4 3 4 3 4 2 1 3 0 4 3 3 3 0 2 3 3 5 2 2 2 2 2 2 4 1 1 0 2 4 4 3 2 1 6 3 0 3 4 1 3 2 5 1 2 1 2 1 4 1 1 2 3 1 2 3 4 5 3 3 2 3 5 1 3 2 5 2 2 3 6 2 2 3 0 3 2 2 5 6 5 2 2 2 2 1 2 2 3 3 3 3 3 5 2 4 4 1 0 1 3 3 5 3 1 2 3 3 3 3 1 3 4 3 3 1 2 2 2 3 2 1 4 3 4 4 5 4 3 3 4 2 1 3 2 1 2 2 3 3 4 2 0 6 2 1 5 2 3 5 1 2 1 2 6 1 2 1 2 5 4 3 1 3 1 2 5 1 1 4 3 2 1 3 4 2 2 1 3 4 2 1 3 3 3 3 4 4 2 2 4 3 5 2 4 4 3 2 1 2 0 4 5 2 3 3 1 3 0 3 2 2 1 1 3 2 3 5 4 4 4 3 2 2 2 6 1 2 4 5 1 1 1 3 3 0 0 2 1 5 1 3 2 4 5 3 1 2 1 3 1 3 4 2 2 2 5 4 5 2 3 1 2 2 2 1 0 3 3 1 3 2 3 4 2 4 0 4 2 2 5 3 1 1 1 5 3 4 3 2 1 3 2 2 3 3 5 4 2 4 0 1 3 3 0 1 5 3 2 2 3 2 5 3 0 3 1 3 2 2 2 4 2 4 3 3 3 2 0 1 4 1 0 0 1 2 3 1 1 2 2 6 2 3 2 6 3 2 3 3 4 3 2 5 2 2 1 1 2 0 6 1 1 4 4 3 4 2 4 2 1 2 2 3 3 2 1 4 1 2 2 4 4 0 4 2 2 2 1 2 2 2 3 1 4 1 2 0 2 1 2 5 2 2 3 1 2 1 2 4 1 4 5 3 4 3 6 1 4 3 3 6 4 3 3 4 0 2 3 2 4 3 3 1 4 2 3 1 4 2 2 7 3 2 3 4 3 1 4 3 0 2 4 2 4 2 3 3 1 4 0 2 0 2 1 0 2 2 2 3 1 3 3 4 1 4 1 1 3 3 3 3 3 5 3 3 1 1 0 1 3 3 0 2 2 1 2 1 3 2 4 6 4 0 4 1 4 3 1 4 4 1 1 5 3 1 2 6 3 3 1 5 2 3 2 3 4 3 3 1 5 1 4 1 2 3 3 3 1 0 4 3 2 1 2 1 2 3 2 2 3 2 2 4 0 2 3 1 8 3 5 2 4 1 1 4 2 2 3 1 1 1 3 4 3 1 2 1 2 3 3 3 2 2 1 3 3 3 3 3 4 1 2 4 3 6 2 1 3 3 3 4 2 3 2 3 2 3 1 1 2 4 2 1 3 4 2 1 2 2 3 3 3 2 5 3 4 3 3 1 4 4 0 2 3 1 1 5 5 3 2 5 5 4 2 1 2 2 3 1 2 2 3 1 2 2 4 1 1 2 2 4 1 3 3 3 2 4 0 0 2 0 0 2 4 3 3 4 1 0 3 4 2 2 2 1 5 4 1 0 1 1 2 3 4 5 1 4 3 3 1 2 0 3 1 1 2 2 3 2 2 1 4 2 2 2 2 2 5 2 2 5 2 1 2 3 4 3 4 1 3 3 6 2 2 4 1 3 5 4 5 0 2 3 0 3 3 2 2 3 1 2 5 0 6 1 2 3 3 2 3 1 2 2 3 0 4 3 4 2 5 5 3 3 2 3 4 1 2 1 1 2 3 3 3 1 1 2 4 1 2 2 2 4 2\n" +
                "C: 2 2 5 1 1 0 2 2 3 2 4 0 1 1 2 1 3 4 2 4 2 3 6 3 3 4 2 3 1 0 1 3 4 4 1 0 2 3 3 2 2 1 0 0 3 5 2 3 3 1 3 1 4 3 3 2 3 2 2 2 1 2 1 2 5 3 3 4 3 1 4 0 1 2 3 4 3 2 3 3 1 2 2 2 2 3 3 4 0 3 3 3 0 2 3 3 2 2 4 5 1 3 3 2 0 1 1 3 1 2 2 4 0 1 1 4 2 3 5 2 2 2 2 4 2 4 1 2 2 1 1 1 2 1 1 4 2 0 2 0 1 2 4 3 2 2 1 1 5 2 1 4 2 1 1 2 2 1 3 2 3 2 3 1 2 0 3 3 3 6 4 3 4 4 2 2 3 2 1 1 1 1 2 2 4 1 1 0 7 4 2 3 1 2 1 1 4 2 4 2 2 2 0 3 4 1 3 2 0 2 1 2 5 3 4 2 2 2 2 4 5 5 3 1 2 5 2 3 3 1 3 3 3 4 5 1 2 2 3 4 3 3 1 4 3 1 0 1 2 2 3 3 1 0 2 3 1 3 1 1 3 2 1 3 1 1 2 2 3 3 4 0 0 0 2 4 2 3 4 6 5 3 3 3 3 5 3 4 0 1 3 1 4 2 1 2 3 2 2 0 3 2 2 1 1 3 0 3 3 1 3 1 2 2 2 2 2 2 0 2 2 2 7 1 2 4 2 3 1 0 0 1 1 3 4 0 3 1 3 0 2 2 3 4 4 3 1 1 3 4 2 7 2 3 4 5 1 3 2 2 3 2 1 1 0 2 3 1 5 1 2 3 1 3 4 2 3 3 1 3 5 2 4 2 3 2 3 2 1 2 3 2 2 3 3 3 1 1 3 2 4 0 1 1 3 4 2 4 3 4 3 4 4 2 1 3 2 1 2 3 3 2 2 5 2 0 3 1 4 1 3 1 4 1 4 5 4 2 6 1 3 0 0 5 0 0 1 4 2 5 1 2 2 1 5 2 3 0 2 4 1 3 2 4 5 2 3 2 4 5 2 3 3 4 5 0 3 2 3 4 2 5 2 5 2 2 1 3 2 4 0 1 3 3 4 2 4 2 4 0 2 3 3 5 2 2 5 3 0 3 3 2 3 2 2 2 2 3 1 2 4 3 2 2 4 2 1 3 4 1 2 4 2 3 5 2 3 3 4 4 3 0 3 3 3 1 2 2 3 3 2 0 3 4 1 3 0 1 4 3 2 2 3 2 1 4 2 2 3 4 2 4 3 3 0 3 1 1 1 3 3 2 2 1 2 2 0 1 3 3 2 3 3 3 4 1 4 0 4 1 2 4 3 3 3 1 4 4 0 3 1 2 4 6 2 2 3 1 1 3 2 5 1 1 2 2 5 2 1 2 2 4 6 3 5 2 3 4 3 3 3 2 3 0 4 1 1 3 5 3 3 1 1 2 2 4 4 2 1 4 4 4 4 3 2 3 0 7 4 4 1 2 3 0 2 2 4 0 5 2 1 3 3 2 3 0 3 3 6 3 5 2 2 3 2 2 1 1 1 2 4 5 3 1 1 3 2 1 1 3 2 4 1 2 5 4 2 1 2 1 3 5 1 2 3 1 2 3 0 3 2 1 1 1 4 1 4 3 2 3 1 2 4 1 2 4 3 3 4 3 4 4 3 1 2 1 4 6 4 2 3 1 4 3 2 2 1 3 3 0 5 3 2 3 0 3 1 3 2 2 1 3 1 2 5 2 0 3 3 3 4 2 2 2 2 4 5 4 6 1 2 3 4 6 3 3 1 2 3 3 3 3 2 2 5 2 3 2 4 5 4 2 3 5 3 1 1 3 3 4 4 1 3 3 2 2 1 2 1 1 3 2 4 6 1 4 4 2 0 4 1 3 4 2 4 2 3 3 2 4 3 4 3 2 1 2 1 1 4 0 4 1 6 2 2 3 2 2 2 3 1 2 2 3 2 2 2 4 3 4 3 1 0 4 2 1 3 1 2 1 3 3 2 3 2 2 6 4 4 1 4 2 2 2 3 2 1 1 3 5 1 2 3 2 2 4 5 0 2 2 4 5 3 1 0 2 3 4 1 1\n" +
                "G: 1 3 0 1 3 4 1 1 3 5 1 4 3 4 1 2 3 1 1 2 4 0 1 3 3 1 3 2 3 2 1 1 2 2 2 2 1 2 0 2 3 2 5 5 4 0 3 1 2 4 2 2 2 1 2 2 0 3 4 0 3 3 3 5 2 3 2 2 3 2 3 3 6 1 4 0 1 4 2 5 4 2 3 4 0 2 4 1 4 3 6 3 1 2 4 5 3 3 2 1 3 3 1 1 4 2 3 1 2 2 1 1 0 4 4 2 3 1 2 3 1 2 1 2 4 0 1 3 2 2 2 2 4 1 2 2 0 1 3 3 6 3 4 3 3 2 2 3 1 3 3 1 3 5 0 3 4 2 4 3 2 3 2 6 4 4 2 1 2 0 2 4 1 2 2 2 1 3 4 3 2 7 0 3 2 2 6 3 1 3 3 4 4 3 3 5 3 4 0 2 2 1 5 2 2 4 2 2 4 2 2 2 3 1 1 1 4 1 2 4 0 3 1 2 0 0 2 1 2 4 3 3 0 2 0 1 4 3 2 2 1 0 3 3 1 4 4 2 4 5 2 2 3 2 1 3 5 2 2 3 5 4 4 4 2 7 4 3 2 1 2 2 5 4 2 2 4 0 2 1 2 3 2 0 2 0 3 4 1 2 1 3 3 2 2 5 1 5 2 1 4 2 4 4 1 3 4 6 3 3 1 2 2 2 2 3 3 4 4 3 4 3 1 5 0 4 4 2 2 5 4 4 1 3 3 2 2 3 3 6 3 2 0 3 2 4 4 4 5 2 3 2 1 2 2 1 3 3 4 2 4 2 1 0 4 2 2 4 1 4 1 4 2 2 0 2 3 2 1 3 1 5 3 3 0 5 3 4 4 1 3 0 4 3 2 3 2 3 4 2 1 3 2 2 3 2 6 0 3 2 3 3 1 3 4 1 5 3 1 4 2 6 3 1 3 3 0 4 3 2 2 4 1 5 2 2 1 3 2 4 1 1 3 1 2 6 6 1 2 3 3 1 4 4 2 2 3 1 3 2 4 3 3 1 1 2 3 3 1 0 5 3 3 3 3 5 3 4 3 2 5 0 2 2 4 2 0 2 2 0 1 3 0 3 3 3 1 2 0 1 0 1 1 1 2 1 1 3 5 2 2 0 3 2 3 2 5 3 3 3 1 2 3 3 2 5 1 2 4 3 4 1 4 3 2 4 1 0 2 0 2 5 4 5 2 2 2 3 2 2 5 4 1 2 2 2 3 1 0 2 0 1 2 2 3 1 1 3 0 3 3 2 4 2 3 0 1 2 4 1 2 4 6 3 1 3 3 5 3 3 3 2 4 3 3 6 2 2 2 3 4 2 2 4 2 5 1 5 3 5 6 3 0 0 2 4 3 4 1 3 1 1 4 2 4 4 1 0 2 3 2 4 0 3 2 3 3 3 2 3 0 3 1 3 2 2 2 1 2 0 3 2 4 2 3 0 3 6 2 1 1 3 0 2 3 2 2 1 1 2 4 1 3 3 4 1 4 2 2 2 0 2 3 2 4 3 2 3 2 3 2 2 2 1 5 2 5 3 3 3 2 0 2 0 2 1 3 2 4 5 1 2 2 3 3 1 5 4 1 4 3 2 4 2 1 5 3 1 4 4 1 2 5 4 2 4 1 1 2 2 3 6 2 2 3 2 1 3 2 3 2 3 0 3 3 4 1 1 3 2 2 2 2 3 0 4 2 2 4 1 1 0 2 3 3 2 1 3 5 3 1 4 1 2 0 1 3 2 2 2 3 4 2 2 4 2 2 1 2 2 1 1 3 3 3 3 3 3 2 1 2 3 0 4 4 4 3 5 1 0 2 1 2 2 5 3 2 3 2 1 2 3 0 4 4 2 4 5 1 4 1 3 1 1 4 2 2 5 4 3 4 4 2 1 2 3 2 1 3 2 2 2 4 0 3 2 3 4 3 1 2 2 0 4 2 2 4 2 3 4 3 2 1 1 4 2 3 1 2 4 1 2 5 2 2 4 4 2 4 2 4 3 3 2 6 3 0 4 1 5 2 2 3 1 3 3 2 2 1 2 3 2 3 3 2 5 2 4 2 3 3 3 2 4 5 4 2 1 3 4\n" +
                "T: 4 3 4 4 1 2 4 4 2 2 0 3 4 3 0 4 0 2 5 2 3 2 0 3 2 0 2 3 2 3 4 2 2 3 3 6 2 4 5 3 2 4 4 2 2 2 3 2 3 3 3 4 2 3 1 2 2 1 2 6 2 1 3 3 2 3 1 2 2 2 3 3 2 3 1 3 5 2 3 0 2 0 3 1 6 3 2 2 6 3 1 2 6 3 2 1 5 2 1 2 3 1 0 4 5 6 3 1 3 3 4 2 4 3 1 3 1 3 1 4 4 3 3 3 2 3 7 3 3 3 2 3 2 3 3 3 6 3 2 5 3 1 1 1 4 2 4 2 1 1 4 4 2 4 5 2 1 4 3 3 2 2 0 1 2 4 3 4 3 0 3 2 5 2 2 2 3 3 4 0 4 2 5 1 3 4 1 2 1 1 4 1 4 1 5 3 1 1 5 4 3 3 0 2 1 3 2 1 5 3 5 1 0 4 2 1 2 5 3 2 2 0 4 2 2 0 4 4 3 3 3 2 5 1 2 5 1 2 0 2 2 3 5 3 5 2 3 2 1 2 3 2 3 5 4 3 1 1 4 3 1 2 3 1 4 0 3 1 2 2 0 3 1 3 3 0 2 6 1 1 2 2 3 4 2 1 2 2 3 5 5 1 1 3 2 2 4 2 4 3 2 4 3 3 3 0 3 0 1 5 4 2 5 5 2 2 3 3 3 1 2 3 1 1 4 0 3 2 4 2 3 1 4 2 1 4 2 1 2 0 1 3 5 2 2 3 1 0 0 1 2 0 4 5 1 2 4 3 3 3 1 3 3 5 2 2 2 3 2 3 1 2 5 1 1 5 3 4 5 1 4 3 1 4 2 2 1 2 1 2 1 7 2 3 2 3 4 2 1 4 3 2 3 2 2 1 1 4 2 2 3 3 2 2 4 3 1 3 3 1 1 2 1 2 3 2 4 4 2 6 0 2 1 1 2 2 2 3 0 2 3 4 3 2 4 4 2 2 3 2 5 2 1 3 1 3 2 4 2 4 2 3 2 3 2 4 0 3 1 2 0 1 2 3 1 1 3 4 4 3 1 2 5 2 2 4 3 3 3 4 3 3 5 1 0 1 2 4 1 7 6 5 5 2 6 1 3 3 1 1 2 4 2 2 3 5 1 2 3 2 3 4 1 4 2 1 4 1 2 2 2 3 2 3 1 2 4 4 3 2 4 3 3 0 4 5 1 3 3 2 2 4 5 2 3 4 3 3 3 1 5 1 4 2 3 2 1 1 4 0 1 4 1 2 5 3 5 4 4 2 3 1 1 2 5 3 0 1 2 1 1 2 2 0 0 3 2 4 2 2 2 1 2 2 1 4 3 1 5 1 3 3 4 2 3 3 1 2 4 3 3 3 4 4 1 1 1 5 2 2 3 1 3 4 2 2 1 3 3 2 6 3 5 4 2 3 1 2 3 3 3 3 2 5 1 2 2 1 2 2 4 1 0 2 2 4 3 0 2 2 2 3 1 4 3 2 1 4 2 4 6 2 1 5 3 3 2 2 1 2 2 4 3 4 1 3 2 4 2 5 2 2 4 1 4 1 3 3 4 1 3 2 5 2 1 4 2 2 3 2 3 1 4 4 3 1 2 4 4 2 4 4 1 2 1 1 4 4 2 2 0 0 3 4 2 1 2 2 1 2 1 1 4 5 4 3 1 1 2 3 1 5 3 2 6 1 4 2 1 4 1 3 3 1 6 1 4 4 1 2 7 2 3 1 2 5 2 0 1 3 2 2 4 3 3 2 1 2 1 5 5 2 2 0 2 2 2 4 2 3 2 2 4 4 1 2 4 3 3 1 1 4 1 2 2 3 3 2 3 3 3 1 3 2 4 5 4 1 5 1 1 4 1 0 2 3 2 3 3 2 4 1 2 4 2 3 4 2 3 2 3 2 1 3 4 4 1 3 2 7 1 3 1 0 5 2 1 0 3 1 2 5 4 1 0 1 5 3 2 2 3 4 3 2 3 4 1 2 4 1 2 2 2 2 0 2 3 0 3 1 4 2 2 3 2 0 2 4 3 1 3 2 3 3 5 0 1 3 3 2 2 1 3 1 4 2 3 3 2 3");
    }

    @Test
    public void shouldCalculateProfileMatrixAsStringFromListOfGenomes_testCase2() {
        String input=">Rosalind_7719\n" +
                "AGCCAGAACAACTACGTTAGTAGTGCCACAGCAATCAGACCGCATTTCCGTTCGTCGAAA\n" +
                "TTTAGCGAAGATAATTAGAGCCGTCGTAAGGCCTGCATATGGATATCCTCATTGATAAGA\n" +
                "ATTCCCTAAAGCTCGACGATGTCACCGTAAACCTTACTGGGACTGGACCCGTGAAACATT\n" +
                "TCGCATGTTCGGTTGTAGGAATGGCTATGTTTGAGATTAGGGTGGTGTTCCTCGTTGTCA\n" +
                "AGTTATCGGGTTCTACCGCTGAAGGTGGATTCCTTCTATAACAGAAGGGTACTCTCGTCA\n" +
                "CTAATGGGCATAATGCTTAGGAGAGCCACACCCCCAAAGGAAACGCGTCAACGCACCCCC\n" +
                "GTTGGCCACCGTTATAATTTTCTACATCTAGCGGCAGTGTATAACGCGCACTTACAATCG\n" +
                "TTGGATGAAGCCCCTTTATCATGCTATAAGCGGCGTCCCATCATGTCCTTGGTGCGATTA\n" +
                "GGTGCAATCCCTACTAGTGCAAAGACAGTTCTATAATTGCAGTTTCCGATGTGTCATTTA\n" +
                "TCGTTTTCATTGACGCAGGTTAGAGCGTGAATAAGATGAATAGTCGGGTCGAGACTGTCA\n" +
                "ATATCCACCACTCAGTGGGGAGTTCGCTTCGGACGGCGTATACCCGACCTTGAATTGCCC\n" +
                "CGTAAATTAGTCAGTTGCAGACAGGTTAAACGTATACGCTTCACATGGTACACAGCGCAT\n" +
                "ACGGAAAATGACGGGCCCGGGATGTGATGGAGCCGGTCAACTCTTTCACGTGGAAGGATG\n" +
                "ATTGAACGCTCGAGTACAGTATGATGAGTCAAAGCTCTCCGACGGCCACCAGGATTGACT\n" +
                "CACATTTTTAGAAAGCCTAATCAGGTTTTCCGGTGTCGCGACCGCGGGGCAGATAGAATA\n" +
                ">Rosalind_5525\n" +
                "GGCGGCAAATATGTGCGTTGAGCGATTAGAACCAGCTGCGTTTGGACACGAAGTGACGGA\n" +
                "CCGGATCTGTGGGGAAGGGAAAAGCAAGCCTGCGAGGAGGCAAGGTCTTCTAACGTCGTC\n" +
                "TACGATCGGGTAATGTCAAGGGTTGGCACGATGCAATCATCATGAGCCAGCTGACTTGCG\n" +
                "AGGACTCCGATCCCCACCGATTGGACGAGCTAGACGTTGACTGCGTCCTCGTCTTTTCCA\n" +
                "GCTTTCAATTAAGTCGGGTGAGTCGTGGCCCCATACATCCCAGGCCCGCTCTTATATTCT\n" +
                "CTTGATGTGCTGATCTTCTCCTCCGTGGTCGACGTGAATTTTTTCTCATGATTGCTTCGA\n" +
                "AACTATTTACCGCAAACGAGGGCCACGACCGAAACTGTTCTGCCGCGAGCACAATCTTGT\n" +
                "GCCAGGAGAGTTCTGAAGCAATTTAAACTATTAAAGTTACTTGCCGAAGCGCACGGGGTG\n" +
                "TCTGACTTCGTCCAGAGCAGAGCGTCAGGCTCTAGTCTTTGAGCACACAAAAAGGAGCCT\n" +
                "AGGTCATTTATCAAAATCTCTGATCCGACCTGAGAGATACAGCCCCCTCTTACTCTTGGC\n" +
                "CAGTTTAGAGAGTTGCCCCCTCTAGTATCCTCGGGTGAACGACGCCAGCGCCTGTACGAG\n" +
                "AACCCCTATGTTTTTCTGGTATAGGCTTGAGACATCAACGGCGCTCAAACTCACATTGTT\n" +
                "AAGCGCTTAGGGATTCTCCCAAGATAGTGTTAATTCTCGGCTCGACGTCCATACGCCCGG\n" +
                "ACTGCCTCACCACACGCTCGCAACACACTTACCTCGTCTCCTCATGACGGAGTCCATTAG\n" +
                "GCGACGCTGCTAAGGCCGCCTCCATCAATCTACCGCGAACAACGTAGCCCCCCCCGAGGT\n" +
                ">Rosalind_3422\n" +
                "AGGAACATTCGCAGGTTACTTGAGGTCCGTTAAGACTGATCAAATCATCCTGATCTTATC\n" +
                "GGCGGCCGCCTTTCCTTGCAGGTTTGCACCTAGTCTGCCAAAACCTTTGCGCTACACCTA\n" +
                "TTCTATCACGAATAGCCTGGCCCCGGCGTACTCGGCGAACGCCCCGGGCATCGTCGATGT\n" +
                "TGGGGTTATAAGCTCTAAACACATGCGATCTTATGCGGATTAAACGATTTAGGCGCGTCA\n" +
                "CCATCCGGTTATGATCTTAGCGAGTCCATTGGAACAGGAGTATGATCCTTGAGTGAGACT\n" +
                "CGAGCCTACTATTTGGCCACAGACGAACTTCATGGACCCCTAACGAACCAATGGGCAGGG\n" +
                "CTCAAACCAAACAGCTTAAATGGAGCAATTTTTATTAAACGCTAAATATATTTAAGTCAT\n" +
                "TATCGACAATAGATAGATATCCGTTACACCGACTTGCTGGCTGCCCCTTAAACGTATCCC\n" +
                "TGTATTAGGTCGATTGGGCCTAGAACAACTGAGATAGGATACTTAGCAAGCGCCAGATGT\n" +
                "TTGGTCCGGCAGCACTTGGGTTAAGAATGGATATAGCTGATCTTGTAGACTCTGTAAATG\n" +
                "GCCTCCTCATGAGATAAGGGTCCTGTACATAGTGCCGGGTGGGAATAACAAGGCTGGGCC\n" +
                "TCTCGGTCGTCGGACTACCGCGAGACCTTGCGAGGCACCGTCAACCCCTGATTCCACAGA\n" +
                "GACATCTTCGTAGGATTGGCTAACTTTTTCGGACATTGGCGCCTGGGATCCCGCGCGCGG\n" +
                "CTTTTGCATACGCGAGGCGAAGTGATTCGTTAGTTTAGGAGTTGTAGCCCCCATTCGGGG\n" +
                "AGTAGGTAATCTCTCCTTCGGCTGTGAGTCGCCCGCACAAGTGCCCCGCCATCTTGGCGG\n" +
                ">Rosalind_1665\n" +
                "ACGAAGCTAGATATAATTCGAGCGAAGCCGTTAGTTATTTGTAATCCGCTCTCGGGTTTA\n" +
                "CTGTTTACACCGATAAATCGCATTACGAGCACGATATCCGAGCCACTTTCCCGCGGCATG\n" +
                "GTGGACTAGTAAACGAGTCGGCCCATACTCCGCAAGGGAGCATGGACACTCCGATTGATC\n" +
                "ACTGAACAACCCGTGTAGAAAGTATCGCTTGTGGGGATCATAACCCCAGCAGAGGGACGA\n" +
                "GCTTGGCGACGCCCGTGGGGAGAGGAAGGTTGTGCCTTAGGAGCATTACTGACTACCTGT\n" +
                "AGTTACCACGCACACTTGTATTTCCGGCTACAACCAGCATTTTCTCGACGAATCGCCTTT\n" +
                "ACGGTCGGGAGGTTTGCACCTGCTAGCTAATAGCACCGTACTAAGTCCCTCTCCGTCTTG\n" +
                "TCATTGCGGGTTTGAGAATTACCACCACATAAAAAAGGTGTCTAAACCTTTCCTATCGCC\n" +
                "GACCGCGTATCAACCTTGTTATCAAGCACAGCATAGTTCAGAAGTGTACGCTCTGTCTCG\n" +
                "GCGAAGGTCCATACTGGGTCTCGCTGCTACGTGTCCGTGCCCTCCGTTCCCGGGAGCGCT\n" +
                "GGTTGCATTGAGTCGGTCTTTAAATGAAGTAATCATTTCAAAGGGAGCAGATTACAACTG\n" +
                "CTCTACCGATCATCACGCTTGTTGCGCCGCAAACGCTGTCATGAAACTATGTACGTATTG\n" +
                "ATATGAGCCGAGGCATTTAGTTATGCAGATTTGTTACCCCCCACCCAACTTCCCGTATGC\n" +
                "ATTGCCAGCTGCCGATTCGCTTCCTTGGGACAGCAGCAGCGCAGCAAAGTAAAATCGAGT\n" +
                "GGCCGCGGATATAGTTACAGAAGGTAAGCCGCGATTAAATAGCAATGCCGGAGCCACTGG\n" +
                ">Rosalind_5776\n" +
                "GCACTGCCCTTGGTCCGCTGCTCGCAAAATTGTGGACTGCCCTTATTCCGCCCAGCAGCT\n" +
                "TGAAACCTTTTACAGCGTTCAGAAGCTGGGAGTCCGAAAACGCCATGGACGCCAATCTGG\n" +
                "AATAGAGCGTGGAACCCCGATCATCTACACCAATATATTGTTGCTCATAACGGAGATCTC\n" +
                "CATGACAGAAATTGCGAATGTTTGACCGCCTCCCGTAAGAATTGGCCGCCACCTCCGCAC\n" +
                "CGGGGGGCCCAGCGAGCGGCAGAAACCAAGCTTGACAGAGTAGCCGCGCTACGTGGCTTG\n" +
                "CTGAAATTAGACAGCTGACGGCACCATCCGCTACGTGAACAACAACAGGGGAGAATTTCC\n" +
                "CGTGTGAGGAGCTGTCATCGGGGGGTTCGCGAAGTATATCCCAGGATGGGAGAACACTTA\n" +
                "ACACAATACTAAAGCTTAGTGCTGTATTCCATGGATTCCGACGAGCCCTTTCAGTAGCAT\n" +
                "TTAGCGCACGTCGCCACAGTCAGTGTTACGATGTTGACGCTGCCACGTGCACAAACCACG\n" +
                "TGAATGAAGATGCATGAGCCACAGCGATATCAATGGCCCACATAGGGCAGCAGCTGTCAC\n" +
                "GGCATCTCCTCTGACCACAGGCATCCATACTTTGGGCTGGATAGGTTGGGGGCTGCCTAC\n" +
                "TCGAAATCTTGTAGGTTAGTAAATCCTGCAACAGGAGGACTAGTACGATCCAAATCATGA\n" +
                "CGAAATCCGCAATCGCAAGGATAATTCGTCACTCAAAAGCGATAGTATTCTTTGCCGCTT\n" +
                "GCATTATAATAATAAGATATCCCAGATAAGATTAGTTGTGACCGCGTCGGCCTACGTCAG\n" +
                "CGTCGTAGACCACGGTGTCGCTCGGTTCATGAGCACAACGTGCTTGTGACTGCGAGGTGC\n" +
                ">Rosalind_7105\n" +
                "GGAAAGCATTACTCACATCGGGATCGGAAAGGTATGCATAGGTTAGATTCCGCTCCTCGA\n" +
                "ACACTCACGTCTTCTCTCTGTTTGGGGTTTCACGACTTCGCGTTTGTGAATGCTCTGTTC\n" +
                "AAATATCTAACTAACGGCTTTACTGTTATTTCACACGATATGCTAAGCGAACTAAGGCTT\n" +
                "CAAACACGAGAAGTTCCGGTCACCTGGTACCCAGCCGCTTTGCACCCCCGCCGATAGTCA\n" +
                "CAGGCACACGAAATGAATGTACTACCGCGAAGCACTCCATATTCATGGGAACACTAAGTA\n" +
                "ACGCCGGGAAGCTATATAGGCCGATTCCTAATCTGAAAGCAATACGTCCCGACCAAATCG\n" +
                "TTTTAAAGAAGCCAAATCAGGCACTGCCGGATCAATATCAGAGATTAAGAGACGCGAGGA\n" +
                "TGATCGGAATGACGCTATCGGAATTCTTTTCGCGTGGACATCGTACATCTTGGCAACCTG\n" +
                "AACAAGGCCCCACGTGTGGGACGGTCCTAGTCAACCCCGACACTTTCCAAATGGCGCGTC\n" +
                "CGCGGACATGACTCCTCTCGTTGTTCACATGACTACCTAGGCGTCAGTTCCCGATGGTAA\n" +
                "CTCAGGCTCGTACGGCATCGGGTGTCGTCTAAGGCCCGTCGCCAAGTCTATAGAAAGCGG\n" +
                "GGTGGCGCAAGTCGCGCTAGCGTTATTTGGGTGGGATTCCTAATTTGGGATAGAAGTTGT\n" +
                "GCGAGGATAAGAAGTGACGATAGTGTTCTACACCGGCCTCCTGATCTGAGGCTCCCACAA\n" +
                "CTTAAACACTCAGACCTTAACTGATATACCTAAGTAAGACAGTATAGTCATGATAATTAT\n" +
                "CGATCATAATCGAGACCTTTGCACCTAGTTCCGAAGTGTCGATGTAAAAAGACCCGGAAG\n" +
                ">Rosalind_8947\n" +
                "TCGGCATCGCAAACACCCTAGCTACTTAGTACAAGTCAGAGAGCCCGACGTGGGGACAGG\n" +
                "CTACAGCTTCAGAACGTGTTGGGCCTTGACCATCAGGGCGCACGAAGATTAGCTCCTGCT\n" +
                "TACAGAAGAGGTCTGGACCACCGGGACACCGTTCTGTGAGCAATTGATATTGGCCCCATT\n" +
                "GAGCAACCGCGTCTCATCCGCTGACTGGCGACTCGGCACCACGACGCACTTAGGGCCCGA\n" +
                "GCTTTGCTAGGTCCATACATATGACCGTTGGCTGAACACACCGATCCTTGTCCGACCGAA\n" +
                "ACTCCCTGCGTCTTTGGCACCAGATCTAGAAGGATAAGGAGACCGATATTGTCAGTTAAA\n" +
                "ATGCGCCAATTAGACCCGGAGAACACCGGGTCTCTCATACTCAGTCCTAAAAAAAGGTGC\n" +
                "CTGTCTGGAAACTTAAACGCGTTGGGGCAGCAGTAAAAGGGGTGCCTCGCATTCCACTAA\n" +
                "GCCCTACAGGCCGTAAACTTCGACCTTGCCTGTCCATCTTATCACCGTGGAGGCAGCTGT\n" +
                "GATAGAAAAGAAACACCGGTTGTGATGGGTCAGAAGGAAGCTTCTGTGGGTAAAACCGCT\n" +
                "AACTCCATGTGCGAGGTGTCACACATGGTTGTACGTCCTCAGCACGTCTTGGGATGGGCT\n" +
                "AATCTCGAATGTGAATATTGGGATTCGCATCGACCCCTTCTCGCCAGAGCCGGATGCCTG\n" +
                "TGCTGTCGACAATATAGTGGCCGCCTAATCCACAGTGGAAGACTACCTGCGCGAAGTATG\n" +
                "CGTAATACAGAAATACAAGTCCTATCGCACAGTTCCGGCACGGCCTTGGGTAAACTGAAT\n" +
                "GCGCGAATCGGTCCATGCATTCATCTTGAGGTTCGTAGTACCGGATATGAACGCGAACGC\n" +
                ">Rosalind_9541\n" +
                "GTTGACCTGAAAGGCTATCGCTATCTGATGGCCGCGGCAGATTAGATATCGGTTCCAGTA\n" +
                "CGGACGGAGGGCCTAACAACCCAGGCGGAATATGAGACAAAAGGACGCCCAGGGGATCCA\n" +
                "AACGCATCCACTCTCCCGATATACTACTCGAAAAGCTCCTCACCGAACGCAATGCAGAGG\n" +
                "CGATCTGCAGCGTTCGCTGCGCTGCTCAGACCCATGAGTGGGGGTTCTCATACTGCCCAA\n" +
                "CACTTCTGAATTATCTTGATAGTACCATGGGGTACCAGTGCGGCTAGGATGGCGCTACTG\n" +
                "GAATGATTCCGCGTTTTCACACCAAGCGTGTGTATGGGATCATCGATTACGTTGTGTGCG\n" +
                "ATTAGGTACCCGCCGCGCAAGCCTAGAAAGTCAAGTCTTACGCACCGCGCTGCATTCGAT\n" +
                "ATTGCAAATTCGTACTCATCCGTGGGTATACCCTAGGCGCAGCAATTGGTTCTGGACCGT\n" +
                "TCTGTGAAATTAATTTGCACGCTACGGACGCCGCCATGGGTGACTACGGGAGATCTAGCC\n" +
                "GCGATGTGGCCAGACCTTGGCCAACCAGTATCGGCTCCCATTGCATTGCAGCAATAGCAG\n" +
                "AACTATTTGTCTCTCGGTATTAAACACTCACATTCGCCGAATTCTATAATAACAGAGTCT\n" +
                "ACTATACATATGGGGAATTAACAAGTAGGGGCGCCTGAAAAATGTAAACCTCTACGCTGT\n" +
                "TTTCTCAGGAGCCAGGCACACTTACGTTCGGTGTGTCGTTCGGTCTAATTATTGGAGTAA\n" +
                "CAGACCGACAATCTTAGAAGCAGGGTCCATGGTCGTCGCCCCATAGCTAGCTACACATCA\n" +
                "GATGGCCCCCTTCGTGATTACTTTGGAATTGAATGGTGCAATAATTGACTGCCGCGCTGA\n" +
                ">Rosalind_2239\n" +
                "CCCGTCTCGTCCGGACCACTGAGACCGGTGCGCGGGCCTCCATATAAATCTTCACCCCGA\n" +
                "ATGACCGCTAAAAAATCATTCACCGGCCCACCCAGGGATCTGGTAGAGATACTCCCCCGC\n" +
                "CCTAGGTGAGTTGTTTCTCCCTAGTGTACGGGACCCGCTTTAGTTAGCCTCGTACAATGC\n" +
                "ATCGCCTCCAAACACAGAGTATTTCCACAGAATGTCCATATGCGAGAAGCCTCCTGCCGT\n" +
                "GCATGTGATGGAATAAACTAGCGACTACCCAGCGAGATAACAGTAGTGACGATAACGGCT\n" +
                "AGGAACTTCACTTTATAGTCGGACACCCTTCCTCAATGAACCGGATTGACTGGCAAGTAG\n" +
                "TATCCTGTAGGAGTTTACAGTGTTTTTGAAGAAATTTCGTGATCCCTCGATCACCTACGC\n" +
                "GACCTTTTATCCCGCCGAGGCCCTTGTGCCTCAAACACCCAGGACTGACGGCGCTCCCAT\n" +
                "CTGGTTGCGTGTGGGACTTGCGACCGGTTCTCACACCACTATATAACTGCAAGCGTAGTA\n" +
                "CACAAACGCTCGTCCCCCAATTCTCGGCAGAAAACGGTGAAGTGCTTGAGTCGATGGAGC\n" +
                "TTATAGGGAACTCAGCGAGCTGCGATGGTGGAATTCGCGCAAATGCGGGGGGAGAGCCGT\n" +
                "TCAGTCCTATCTTGCTACCCTGGCTAGAATTGACCTATGTGTAGCGGATGGAATTCTCTC\n" +
                "CAGACATCATAGTGCGTAGACCAACTTTTCTGCCTAACCCGCCCTAAGTACGGCAAATGG\n" +
                "TGTGCTCGATCTAGTATATTCCGTCCAGCGACGCATACGAGGCCAGCACCGGCCGAATGG\n" +
                "GTCAACGAATGCTGCAAGCGGGTCAGCTGTGTCACGGCTCAATGATACGTACTCTGGGGG\n" +
                ">Rosalind_8229\n" +
                "GCGCCGCCTTAGGTGGTCTTTTCATAGGGTCGCTACCAGACAAGGTGTTTTCTGAACTCA\n" +
                "CTAACCGCGACATAGTCCTGTGCGAGGATAACGTCGGGTCATAATCTTGGTTCGCGACCT\n" +
                "CCATCCCGCATATATATTTTATTCTAATGGGTGATCCGTATCTCCATTCACGATTGTCAT\n" +
                "GAGGGGTGTCCTCGGCCGTAGACCATCTCGACCTATAGGGACCGAGCAAGTTCTTCACTA\n" +
                "AAAAAGGGGGGAAAAGGCAGAATATATTATCTTGCCCACAACTGAATGGTAGCGGGTTGT\n" +
                "CGCAGGCCACACTGGTGGTTGCAGACGCGCGGCCTAATTAACTCTGACCCACGTTTCTGT\n" +
                "CGACCATCCAGCATTGTTCGATATGTATGATAGGCTAAATTCCTCTTCCTCCAGTCAGAA\n" +
                "TGCCTACGCTGTGCTCTTTACGGTAGAGACTGACACATCTGCACTATCTCCAAAGGCCCT\n" +
                "TAACAAAACGTTCGTACCAAGCTTCTCCTAACCTCTAGGGGCGATATTCCTATAATTATC\n" +
                "GAGTTGATATCCAAGCTTGCACAAGTGGCAGTTAGCTTCTTGGGACGGGGGCCGTCCCAG\n" +
                "TCGCAATTACGTTTTAAGCCCTCTGGCTCATATGTCCTCTATTACAATCTCGTGGACACG\n" +
                "TGGCTGGAAAAAGGGGTCACTCTCGGCAGAATGCGATCCAACACGTTGTAGCAAGACTCC\n" +
                "CATGGCATGCCTACAAGCCTCCTCTGTGAAATTAAGAGTATCGCGTATAGGCGCTCGTAT\n" +
                "TCCCTTTATTAAGATCCTAGCTGCATACTATAGTTGGGGTGAAGCTTCCATCACAGTTAG\n" +
                "TACCGTCTAATTTCCTAGTTCGGCGTCGACGTTCTTGTTGCCAAAGTTCCTGTCCTGTAC";

        ProfileMatrix matrix = createForGenomes(getGenomes(input));
        String output = matrix.getConsensusString()+"\n" + getNucleotideOutput(matrix);

        assertThat(output).isEqualTo("GCGGAGCCGTACGTACTTCGGGCGCTGAGTGCAGGCCAAACATATAAACCTGCGCCCAGACTAAACCCGCAAAAATCGTGCGAGGGGAACAACGAGGACGAGACATTTTCACCCCTCCTAAACAAACGAAGAAAGACTATCCCCGACACGATACACGCAGCACCGAACCACGGACAGATTAAGGATCCAAAGCTCAAGGAATTGCCGACCTCCAGGAAGATGCGCGCACCATCTTCGCCACCTTGGCGAGAAATAGAGAGAGAACCGGATCGTGCCAAAACAGCAACGCTACCGACCTCTCGAAACTTCAACTTCTTCACGCACACCCTACACCTAAAAAAATCGATACCATGCATTTCGATTCAACAAAGCCATAACAGGGATACAAGATAAATTATTCCCAACCTCGAACAACGATGATCACCACAATACCGCTAATCCCTTTATAACCAAAAGACCGTCGACCCCTTTCACGACCATTATGTAAACGCAACTAGCACAAAACCAACCTCATCATCGTAAATTCCTAGAAGCATCTCCGAGATAAAACAGAACCTGGCTCAACCGTAAAAAAAGCTAATCTCCGGGACTCGATGGCACAACTACATATCTCAGCAGCCTCATCTATCTAATGGCCCGCAACACAACCGAGGATAGCCGTCTCTCTAATCTGGCTACAGAGAGGCTAGAAGACGAAGCCTCACAAGATCCAAAGCCTGTAAGAGCATAGAAAGACTCGGCAAATTTTTCAACCGAACGCCCCTGCAATCGCGCGCGCGGCTTGCACAATCACAAACAATCTGATTACACAAGTCTAGGCGCCGCGCCCGAGAAAAGTAGGGCAGCCTATCTAGCCATCGCCAGGTAGTCGAGCGTAGTAAACGATGCCCACCCCGGTGG\n" +
                "A: 3 0 2 3 5 1 3 3 2 2 7 2 3 1 4 1 2 2 1 1 2 2 3 3 2 3 1 6 2 3 2 1 4 4 2 1 2 3 3 3 1 4 3 5 2 3 3 4 0 0 1 1 1 2 1 3 2 3 1 7 2 0 4 5 3 0 2 2 2 2 3 3 4 5 4 3 2 2 2 2 2 3 3 1 2 1 1 4 3 3 3 4 0 2 4 1 3 3 3 3 4 4 4 1 6 1 1 1 3 1 4 1 1 2 2 2 2 2 0 3 4 5 2 3 4 3 1 3 4 4 2 4 4 4 0 3 1 1 3 2 2 1 3 1 1 3 3 4 2 2 3 2 4 3 4 2 1 2 4 2 0 6 1 0 2 5 4 1 3 4 2 1 1 6 2 4 2 4 1 0 3 4 2 2 4 3 1 2 4 4 4 2 0 1 0 3 4 3 2 4 4 2 1 2 3 0 2 3 2 1 3 2 2 3 1 1 4 3 2 4 3 2 2 3 2 0 2 4 1 1 3 2 1 1 0 1 2 0 2 8 2 3 3 1 2 1 1 3 3 1 4 4 4 2 5 2 3 0 4 1 7 2 4 6 1 2 3 2 3 1 2 0 2 3 4 2 4 3 5 4 3 5 1 1 6 3 0 1 2 1 4 3 1 2 3 3 2 1 1 3 4 1 3 4 4 2 0 2 3 3 3 2 3 2 1 1 1 2 4 1 2 2 4 4 3 2 1 2 0 4 2 3 2 2 1 7 5 4 4 3 4 6 2 2 2 3 3 3 2 2 5 3 0 2 4 2 2 1 2 2 4 2 1 2 3 3 2 3 5 5 1 2 2 4 2 3 3 2 5 3 1 1 3 2 4 1 3 3 3 4 1 5 4 5 2 2 4 3 3 3 1 2 4 5 1 2 1 3 1 5 3 2 5 6 2 2 4 0 3 3 2 2 3 1 2 4 2 5 6 1 3 2 2 1 3 2 5 5 1 2 3 1 1 1 2 4 3 3 4 2 2 3 4 3 7 2 3 2 1 2 3 0 2 4 3 2 2 2 0 1 2 2 3 1 2 5 1 0 3 2 1 3 2 2 3 3 4 4 2 0 0 3 4 1 1 6 1 1 3 1 4 3 3 3 3 0 3 4 1 2 2 1 4 3 3 4 2 1 1 2 4 3 3 2 4 3 1 2 4 2 6 3 3 2 4 2 3 2 0 2 1 3 1 5 2 4 3 3 3 2 4 2 5 5 2 1 2 0 1 1 2 1 5 4 1 1 4 1 4 3 3 4 5 4 4 1 1 1 4 5 2 2 0 1 2 1 1 0 3 1 0 4 2 5 2 2 1 2 4 2 3 3 2 2 3 1 4 0 4 2 2 2 0 5 0 2 4 1 2 0 2 2 4 3 2 1 4 1 2 2 3 5 3 0 1 0 0 1 1 3 6 4 2 4 2 3 4 2 2 2 3 2 2 5 2 5 1 1 2 0 3 2 1 3 3 3 0 4 6 3 1 2 2 2 2 1 4 1 3 1 4 1 6 1 2 1 1 3 3 4 3 2 5 2 0 4 3 2 2 2 3 3 5 2 3 3 2 5 2 3 1 4 5 6 2 2 2 1 1 2 3 4 2 4 2 3 4 1 4 2 5 4 3 2 3 2 2 3 1 3 2 4 4 4 0 1 3 1 2 2 3 3 2 2 3 3 3 1 2 3 0 2 1 2 2 1 5 4 2 1 2 0 1 2 3 2 3 2 3 2 3 1 1 3 3 3 2 5 4 2 4 5 3 4 4 3 2 4 4 2 2 2 1 4 3 2 4 2 3 2 5 5 2 1 2 1 3 1 1 3 2 2 3 2 2 3 2 3 1 2 3 2 6 4 3 3 2 3 5 1 1 3 1 4 1 2 2 3 6 2 1 3 4 1 2 1 4 0 3 2 1 1 3 1 1 1 5 2 3 0 0 3 1 3 2 0 4 3 3 3 5 3 2 3 4 2 3 2 2 2 4 2 1 0 2 2 3 2 2 2\n" +
                "C: 1 5 3 3 2 4 5 4 2 2 1 4 0 2 3 5 2 3 5 0 2 1 4 0 5 2 2 2 2 0 2 4 4 0 1 4 5 2 1 3 5 1 1 1 1 3 2 2 6 4 3 2 5 0 4 5 4 2 2 1 5 2 1 2 3 6 4 4 1 3 3 1 2 2 2 2 3 2 2 2 4 2 2 2 3 3 2 1 3 4 3 4 4 2 3 2 0 3 4 2 4 0 3 3 1 3 2 2 1 6 1 4 4 3 5 2 5 4 3 3 2 2 4 1 3 3 4 2 3 0 2 1 2 2 3 3 6 3 3 1 3 4 4 4 2 1 4 2 4 3 3 2 3 4 1 5 2 3 1 1 4 2 4 4 2 1 2 5 5 2 5 3 0 1 5 1 2 3 1 3 3 2 1 2 4 2 4 4 1 4 3 2 5 1 6 2 4 2 1 2 2 2 2 2 4 5 3 2 3 4 2 5 3 2 2 3 2 1 2 1 1 2 3 2 4 3 7 2 4 5 3 2 6 2 1 5 3 7 4 1 4 5 1 0 2 3 4 1 2 2 0 1 4 2 2 2 2 3 1 1 1 2 0 1 4 5 2 2 2 2 3 3 3 0 5 6 3 1 3 1 4 3 0 4 2 2 4 1 3 1 1 4 4 2 1 4 3 1 4 0 5 2 1 2 3 4 2 1 6 3 2 5 1 0 3 1 1 4 1 5 3 4 2 5 2 4 4 6 2 2 5 2 4 5 2 0 1 2 1 3 2 2 2 6 2 3 1 3 5 4 0 2 2 4 1 3 3 2 4 2 3 1 2 3 2 3 3 2 3 3 2 4 3 1 2 3 3 3 3 1 0 3 3 3 1 3 3 3 1 2 0 3 1 2 3 2 2 1 1 4 3 4 3 2 4 4 3 4 3 2 3 3 3 2 4 2 3 2 1 2 1 3 3 4 3 0 3 0 2 0 3 3 4 2 4 2 1 1 2 3 4 4 2 1 1 2 1 3 3 4 4 2 3 2 0 2 2 4 5 3 1 5 1 3 4 4 4 5 2 3 1 5 2 4 2 1 6 6 3 2 1 3 3 3 2 2 2 2 5 2 5 3 3 3 2 0 3 4 1 3 3 3 2 2 4 4 3 1 5 3 2 6 1 3 4 2 3 3 2 2 1 2 3 3 1 4 5 2 2 3 2 1 2 3 3 1 4 1 4 3 2 3 2 0 1 1 3 1 2 3 3 3 2 5 4 5 3 2 2 4 1 4 1 1 4 4 1 2 2 2 2 1 1 0 3 3 4 2 3 2 3 3 1 4 5 2 1 1 3 4 3 5 2 1 2 2 3 3 3 3 2 2 5 1 3 5 1 3 3 1 4 1 4 1 2 4 1 3 3 4 1 4 3 1 3 2 3 1 4 3 1 1 0 3 3 4 6 3 2 4 0 1 4 2 4 2 0 4 4 0 2 1 2 1 1 1 4 4 5 3 2 4 2 4 1 5 3 3 0 0 3 1 1 1 3 2 1 5 2 2 2 3 0 2 2 4 3 2 1 1 3 2 1 5 3 4 2 2 5 4 0 5 0 4 3 3 2 1 1 4 3 3 1 3 2 3 4 3 1 2 3 2 2 2 1 4 2 3 2 3 1 2 1 3 1 3 2 4 3 2 4 3 0 3 3 1 1 1 1 4 2 1 4 5 0 1 3 5 2 5 5 4 5 3 2 4 2 0 3 4 2 5 1 6 2 5 1 4 0 1 4 3 1 1 4 3 4 2 4 1 5 1 4 0 2 3 3 2 1 1 7 3 2 3 1 3 1 5 2 3 1 2 1 3 3 1 3 2 3 5 3 3 4 2 4 1 3 4 5 3 3 3 1 4 3 3 0 1 2 0 3 2 4 4 2 3 3 1 2 3 3 1 4 2 3 4 3 2 4 1 3 5 2 3 2 1 2 1 1 5 2 3 3 5 1 3 1 2 3 3 2 3 4 1 2 1 1 3 5 5 1 4 5 6 5 0 2 2 0 3\n" +
                "G: 5 4 4 4 1 5 0 0 3 1 1 2 5 3 3 2 2 0 0 6 3 4 2 4 2 1 5 2 4 3 3 4 0 5 4 3 1 3 3 2 3 2 1 2 3 1 2 1 0 4 1 4 2 4 4 1 1 3 4 1 1 3 4 2 2 2 4 1 4 2 2 3 1 1 2 1 2 4 1 4 2 4 2 4 4 5 4 4 2 2 1 2 3 3 2 6 5 2 1 4 1 5 2 3 1 2 3 3 2 1 2 3 2 3 3 2 1 2 3 2 1 0 1 3 3 1 1 4 3 4 3 1 1 0 5 2 2 2 2 3 3 1 1 2 4 3 1 1 1 4 3 2 2 1 2 2 4 3 1 4 2 1 2 2 3 4 3 1 2 1 1 4 6 1 1 3 3 1 3 2 2 3 5 5 2 1 2 3 2 2 2 3 2 2 3 2 1 4 5 2 2 1 3 4 1 1 5 2 3 3 1 0 3 3 5 4 2 3 3 3 2 4 3 5 3 4 1 1 2 2 1 2 3 3 4 2 4 0 3 0 4 2 2 2 3 4 4 5 2 5 4 1 2 1 2 3 3 5 3 4 2 5 2 3 3 0 4 3 3 3 3 5 0 5 0 1 1 3 0 4 1 1 6 4 0 2 3 7 3 1 4 2 2 3 3 2 3 3 2 2 1 4 3 2 2 3 3 3 1 3 2 1 1 2 3 2 3 3 1 3 4 2 3 1 3 2 3 2 2 2 2 3 1 2 3 2 3 3 3 1 1 0 1 1 4 2 2 2 1 3 4 1 5 3 3 1 1 2 3 4 1 2 2 3 3 2 2 3 2 1 6 3 2 2 1 2 1 2 1 5 5 5 2 1 3 3 1 2 4 3 4 0 3 3 1 0 2 1 2 0 3 2 1 2 3 1 2 2 5 1 1 2 0 2 1 3 1 3 4 2 2 2 2 2 2 3 3 4 1 3 2 2 1 4 1 2 1 1 3 2 3 2 3 3 2 4 1 2 0 2 1 3 3 2 1 4 3 1 3 4 2 3 5 1 2 1 1 1 3 1 3 2 2 4 3 3 2 2 1 2 3 2 1 5 1 3 3 1 3 4 1 1 3 3 2 2 4 3 3 3 2 3 3 3 1 3 2 3 1 3 2 1 3 0 1 2 1 3 5 2 3 3 2 1 0 2 2 2 4 4 1 3 4 2 3 3 1 3 2 2 4 3 6 2 2 4 1 3 3 2 0 4 1 0 2 2 1 5 5 3 0 2 3 2 3 3 5 3 3 2 3 1 3 2 3 5 3 1 3 2 1 3 4 2 2 4 4 6 2 4 3 1 5 3 0 4 4 3 2 3 3 2 2 0 2 2 1 2 2 3 3 2 3 1 6 3 3 4 3 4 2 3 0 2 3 3 3 2 1 1 3 2 2 5 4 3 3 3 4 1 3 2 2 3 3 3 2 3 2 4 3 6 3 3 3 3 5 3 2 4 1 3 2 2 2 2 3 1 1 2 3 2 4 6 3 2 2 1 2 4 2 4 1 4 4 2 2 2 5 3 3 4 3 3 5 0 2 3 1 2 2 0 4 2 1 1 5 3 2 2 3 1 2 0 3 3 1 1 4 2 2 2 4 2 5 1 1 2 3 4 3 3 3 4 3 3 2 1 6 4 1 0 3 1 2 3 1 3 2 2 2 3 2 0 4 3 1 4 3 1 4 1 3 1 3 1 2 2 1 3 3 2 5 2 4 2 5 0 4 5 1 2 1 4 0 1 1 3 0 1 1 2 2 4 0 3 2 0 4 3 0 1 5 2 2 1 2 3 2 2 1 2 4 2 2 3 2 6 4 1 5 3 1 5 1 4 2 1 4 4 1 4 1 0 1 2 4 1 3 5 5 4 2 1 6 2 2 2 1 1 3 1 0 6 3 1 2 3 0 4 3 2 2 4 4 3 0 5 1 1 7 1 4 0 5 3 3 4 0 3 2 2 2 5 0 3 4 3 3 1 3 3 2 2 1 7 5 2 7 4\n" +
                "T: 1 1 1 0 2 0 2 3 3 5 1 2 2 4 0 2 4 5 4 3 3 3 1 3 1 4 2 0 2 4 3 1 2 1 3 2 2 2 3 2 1 3 5 2 4 3 3 3 4 2 5 3 2 4 1 1 3 2 3 1 2 5 1 1 2 2 0 3 3 3 2 3 3 2 2 4 3 2 5 2 2 1 3 3 1 1 3 1 2 1 3 0 3 3 1 1 2 2 2 1 1 1 1 3 2 4 4 4 4 2 3 2 3 2 0 4 2 2 4 2 3 3 3 3 0 3 4 1 0 2 3 4 3 4 2 2 1 4 2 4 2 4 2 3 3 3 2 3 3 1 1 4 1 2 3 1 3 2 4 3 4 1 3 4 3 0 1 3 0 3 2 2 3 2 2 2 3 2 5 5 2 1 2 1 0 4 3 1 3 0 1 3 3 6 1 3 1 1 2 2 2 5 4 2 2 4 0 3 2 2 4 3 2 2 2 2 2 3 3 2 4 2 2 0 1 3 0 3 3 2 3 4 0 4 5 2 1 3 1 1 0 0 4 7 3 2 1 1 3 2 2 4 0 5 1 3 2 2 2 4 0 1 4 0 2 3 1 3 2 4 2 2 5 2 1 1 2 3 2 1 2 1 3 1 2 3 3 1 2 7 1 1 3 3 3 1 2 5 3 5 0 3 3 2 1 1 5 4 0 1 3 2 5 6 3 6 5 1 4 1 1 2 1 0 2 2 2 0 6 2 1 2 3 1 4 1 1 1 2 3 3 2 5 1 2 2 4 2 2 1 1 4 3 1 2 4 4 5 1 2 2 5 5 2 2 2 3 2 0 1 1 1 3 3 5 2 3 3 1 1 4 1 2 4 2 3 3 2 2 1 5 2 2 0 4 6 2 5 4 3 3 2 2 1 2 3 4 1 1 2 3 3 2 0 3 3 2 5 2 3 5 3 2 3 3 3 2 1 1 6 2 3 3 3 2 4 3 3 4 3 0 3 4 5 5 0 5 2 3 2 3 2 0 3 2 2 2 3 1 1 4 2 2 2 1 3 3 2 5 5 4 1 3 1 3 1 1 2 3 4 5 2 4 0 4 2 1 3 0 4 4 3 0 3 5 2 2 2 3 3 1 1 2 2 2 3 2 2 3 2 4 2 2 4 2 2 4 3 2 4 2 2 2 4 5 1 2 4 0 1 1 3 1 3 0 4 2 4 4 3 3 1 1 3 5 1 3 3 2 3 3 1 2 0 2 2 4 3 2 2 7 3 1 3 2 2 0 4 1 3 2 4 1 4 0 1 2 6 0 1 4 2 5 3 1 3 4 3 2 1 4 0 1 1 6 2 2 2 1 2 2 3 1 7 2 2 4 5 1 4 1 5 3 3 2 1 2 2 2 2 5 1 3 4 2 4 0 6 3 4 3 2 5 2 2 3 1 3 3 2 1 3 2 1 1 2 4 1 2 4 2 1 3 1 4 1 0 2 1 3 4 1 5 1 4 0 4 2 3 5 3 5 3 1 2 5 3 3 3 3 2 2 3 3 2 3 4 3 1 2 1 2 1 0 2 2 3 3 2 2 5 2 1 2 3 3 1 1 5 1 3 2 2 1 3 2 3 5 4 4 2 2 2 2 2 2 3 4 1 1 1 1 3 1 3 2 4 2 0 1 3 3 3 2 5 5 5 5 5 2 3 3 2 3 3 3 3 0 3 1 1 3 1 4 3 4 1 4 4 2 3 3 3 0 1 1 1 4 3 2 2 4 7 2 3 3 3 0 2 6 0 2 1 2 4 1 3 4 1 4 1 4 2 1 4 4 3 0 3 3 3 1 3 4 3 5 2 1 2 1 0 2 2 1 3 2 3 2 0 1 3 1 2 2 3 2 4 5 0 4 1 1 3 1 1 3 3 4 1 4 3 5 2 1 2 4 1 5 3 3 3 2 3 2 3 5 3 2 5 4 1 3 2 2 2 4 2 1 4 1 1 2 2 1 4 4 2 2 0 2 2 1 2 2 2 1 0 4 1 1");
    }


    @Test
    public void shouldParseMultiLineGenome() {
        String input=">Rosalind_2372\n" +
                "ACG\n" +
                "ACG\n" +
                ">Rosalind_2373\n" +
                "ACG\n" +
                "ACG\n";

        assertThat(getGenomes(input)).containsExactly("ACGACG","ACGACG");
    }

    private String[] getGenomes(String input) {
        String[] split = StringUtils.split(input, ">");
        List<String> result = new LinkedList<>();
        for (int i = 0; i < split.length; i++) {
            String row = StringUtils.substringAfter(split[i],"\n").replaceAll("\n","");

            result.add(row);
        }
        return result.toArray(new String[0]);
    }

    private String getNucleotideOutput(ProfileMatrix matrix) {
        List<String> result = new ArrayList<>();
        for (Map.Entry<Character, ProfileRow> profileRowEntry : matrix.getEntries()) {
            result.add(profileRowEntry.getKey() +": " + StringUtils.join(profileRowEntry.getValue().toIntList(), " "));
        }
        return join(result,"\n");
    }

    private ProfileMatrix createForGenomes(String... genomes) {
        ProfileMatrix matrix = new ProfileMatrix(genomes[0].length());
        for (String genome : genomes) {
            matrix.add(genome);
        }
        return matrix;
    }


    private class ProfileMatrix {
        private TreeMap<Character, ProfileRow> maps = new TreeMap<>();
        private int length;

        public ProfileMatrix(int length) {
            this.length = length;
            maps.put('A',new ProfileRow(length));
            maps.put('G',new ProfileRow(length));
            maps.put('C',new ProfileRow(length));
            maps.put('T',new ProfileRow(length));
        }

        public List<Integer> profileFor(Character nucleidAcid) {
            return rowFor(nucleidAcid).toIntList();
        }

        public void add(String genome) {
            char[] genomeAsArray = genome.toCharArray();
            for (int i = 0; i < genomeAsArray.length; i++) {
                char nucleotide = genomeAsArray[i];
                rowFor(nucleotide).incrementFor(i);
            }
        }

        private ProfileRow rowFor(char nucleotide) {
            return maps.get(nucleotide);
        }

        public String getConsensusString() {
            String result = "";
            for (int i = 0; i < length; i++) {
                 result+=highestAt(i);
            }
            return result;

        }

        private String highestAt(int i) {
            int max = Math.max(Math.max(rowFor('A').valueAt(i),rowFor('T').valueAt(i)),Math.max(rowFor('G').valueAt(i),rowFor('C').valueAt(i)));
            for (Map.Entry<Character, ProfileRow> nucleotideCounter : maps.entrySet()) {
                if(nucleotideCounter.getValue().valueAt(i) == max) {
                    return nucleotideCounter.getKey().toString();
                }
            }
            throw new RuntimeException("not expected to be here");
        }

        public List<Map.Entry<Character, ProfileRow>> getEntries() {
            List<Map.Entry<Character, ProfileRow>> result = new ArrayList<>();
            for (Character character : maps.navigableKeySet()) {
                result.add(new TreeMap.SimpleEntry<>(character,maps.get(character)));
            }
            return result;
        }
    }

    private class ProfileRow {

        Map<Integer, MutableInt> positionCounters = new HashMap<>();
        private int length;

        public ProfileRow(int length) {
            this.length = length;
            for (int i = 0; i < length; i++) {
                 positionCounters.put(i,new MutableInt(0));
            }

        }

        public void incrementFor(int i) {
            positionCounters.get(i).increment();
        }

        public List<Integer> toIntList() {
            List<Integer> result = new LinkedList<>();
            for (int i = 0; i < length; i++) {
                 result.add(positionCounters.get(i).toInteger());
            }
            return result;
        }

        public int valueAt(int i) {
            return positionCounters.get(i).toInteger();
        }
    }
}
